

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Exercises &#8212; Modelling and Numerical Methods</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Chapter3/exercises3';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Solutions" href="solutions3.html" />
    <link rel="prev" title="3.1 Kinematics" href="Lecture%203%20-%20Kinematics.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.jpg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.jpg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Modelling and Numerical Methods
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../List%20of%20Symbols.html">List of Symbols</a></li>
</ul>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter1/intro.html">1. Intro to Vector/Tensor Calculus</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1/Lecture%201.1%20-%20Intro%20to%20Vectors.html">1.1 Continuum Mechanics and Vector Calculus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1/Lecture%201.2%20-%20Vector%20Transformations.html">1.2 Vector Transformations  <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1/Lecture%201.3%20-%20Intro%20to%20Tensors.html">1.3 Intro to Tensors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1/exercises.html">Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1/solutions.html">Solutions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter2/intro.html">2 Stress and Tensors</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2/Lecture%202%20-%20Stress%20and%20Tensors.html">2.1 Stress and Tensors  <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2/exercises2.html">Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2/solutions2.html">Solutions</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="intro.html">3. Kinematics and Strain</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Lecture%203%20-%20Kinematics.html">3.1 Kinematics   <a class="tocSkip"></a></a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="solutions3.html">Solutions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter4/intro.html">4 Conservation Equations</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter4/Lecture%204.1%20-%20Conservation%20Equations.html">4.1 Conservation Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter4/Lecture%204.2%20-%20Rheology.html">4.2 Rheology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter4/exercises4.html">Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter4/solutions4.html">Solutions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter5/intro.html">5. Dimensional Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter5/Lecture%205%20-%20Dimensions%20and%20Dimensional%20Analysis.html">5.1 Dimensions and Dimensional Analysis  <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter5/Worksheet.html">Worksheet  <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter5/Solutions.html">Solutions  <a class="tocSkip"></a></a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter6/intro.html">6 Potential Flow</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter6/Lecture%206%20-%20Potential%20Flow.html">6.1 Potential Flow  <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter6/Worksheet.html">Worksheet  <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter6/Solutions.html">Solutions  <a class="tocSkip"></a></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter7/intro.html">7. Navier-Stokes</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter7/Lecture%207.1%20-%20Navier-Stokes.html">7.1 Solving Navier-Stokes Numerically</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter7/Worksheet.html">Worksheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter7/SolversIntro.html">Solvers</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter8/intro.html">8 Turbulence and Non-Newtonian Flows</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter8/Lecture%208.1%20-%20Turbulent%20and%20Non-Newtonian%20Flows.html">8.1 Turbulent and Non-Newtonian Flows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter8/Worksheet.html">Worksheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter8/Solutions.html">Solutions</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter9/intro.html">9. Interpolation Quadrature 2</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter9/Lecture%209.1%20-%20interpolation%20quadrature.html">9.1 Interpolation &amp; Quadrature 2 <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter9/Homework.html">Homework <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter9/Solutions.html">Solutions <a class="tocSkip"></a></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter10/intro.html">10 ODE Solvers 2</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter10/Lecture%2010.1%20-%20ODE%20Solver.html">10.1 ODE solvers 2 <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter10/Homework.html">Homework <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter10/Solutions.html">Solutions <a class="tocSkip"></a></a></li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter11/intro.html">11. PDE Solvers: Finite Difference Methods 2</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter11/Lecture%2011%20-%20PDE%20Solvers%20-%20Finite%20Difference%20Methods%202.html">11.1 PDE Solvers: Finite Difference Methods 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter11/Homework.html">Homework <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter11/Solutions.html">Solutions <a class="tocSkip"></a></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter12/intro.html">12 Finite Element Methods</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter12/Lecture%2012.1%20-%20FEM.html">12.1 Finite Element Methods <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter12/Homework.html">Homework <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter12/Solutions.html">Solutions <a class="tocSkip"></a></a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FChapter3/exercises3.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Chapter3/exercises3.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Exercises</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-outcomes-a-class-tocskip">Learning outcomes  <a class="tocSkip"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#material-vs-spatial-descriptions">Material vs spatial descriptions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-field">Spatial field</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pathlines">Pathlines</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relating-spatial-and-material-descriptions">Relating spatial and material descriptions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-optional">Exercise 3 (Optional)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-advanced">Exercise 4 (Advanced)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-derivative">Time derivative</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5">Exercise 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6-optional">Exercise 6 (Optional)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#infinitesimal-strain">Infinitesimal strain</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#strain-and-rotation-tensors">Strain and rotation tensors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#strain-tensor-components">Strain tensor components</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7">Exercise 7</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#displacement-and-strain-fields">Displacement and strain fields</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-8-optional">Exercise 8 (Optional)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#principal-strains-and-strain-invariants">Principal strains and strain invariants</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-9">Exercise 9</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#strain-rate">Strain rate</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#finite-strain">Finite strain</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-advanced">Exercise 10 (Advanced)</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="exercises">
<h1><a class="toc-backref" href="#id1" role="doc-backlink">Exercises</a><a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h1>
<section id="learning-outcomes-a-class-tocskip">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Learning outcomes  <a class="tocSkip"></a><a class="headerlink" href="#learning-outcomes-a-class-tocskip" title="Permalink to this heading">#</a></h2>
<p>At the end of this session, you should be able to:</p>
<ol class="arabic simple">
<li><p>Use material and spatial descriptions of variables and their time derivatives.</p></li>
<li><p>Compute infinitesimal strain (strain rate) tensor given a displacement (velocity) field.</p></li>
<li><p>Interpret the different components of the infinitesimal strain (rate) tensor</p></li>
</ol>
</section>
<section id="table-of-contents">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Table of Contents</a><a class="headerlink" href="#table-of-contents" title="Permalink to this heading">#</a></h2>
<nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#exercises" id="id1">Exercises</a></p>
<ul>
<li><p><a class="reference internal" href="#learning-outcomes-a-class-tocskip" id="id2">Learning outcomes  <a class="tocSkip"></a></p></li>
<li><p><a class="reference internal" href="#table-of-contents" id="id3">Table of Contents</a></p></li>
<li><p><a class="reference internal" href="#material-vs-spatial-descriptions" id="id4">Material vs spatial descriptions</a></p>
<ul>
<li><p><a class="reference internal" href="#spatial-field" id="id5">Spatial field</a></p></li>
<li><p><a class="reference internal" href="#pathlines" id="id6">Pathlines</a></p></li>
<li><p><a class="reference internal" href="#exercise-1" id="id7">Exercise 1</a></p></li>
<li><p><a class="reference internal" href="#relating-spatial-and-material-descriptions" id="id8">Relating spatial and material descriptions</a></p></li>
<li><p><a class="reference internal" href="#exercise-2" id="id9">Exercise 2</a></p></li>
<li><p><a class="reference internal" href="#exercise-3-optional" id="id10">Exercise 3 (Optional)</a></p></li>
<li><p><a class="reference internal" href="#exercise-4-advanced" id="id11">Exercise 4 (Advanced)</a></p></li>
<li><p><a class="reference internal" href="#time-derivative" id="id12">Time derivative</a></p></li>
<li><p><a class="reference internal" href="#exercise-5" id="id13">Exercise 5</a></p></li>
<li><p><a class="reference internal" href="#exercise-6-optional" id="id14">Exercise 6 (Optional)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#infinitesimal-strain" id="id15">Infinitesimal strain</a></p>
<ul>
<li><p><a class="reference internal" href="#strain-and-rotation-tensors" id="id16">Strain and rotation tensors</a></p></li>
<li><p><a class="reference internal" href="#strain-tensor-components" id="id17">Strain tensor components</a></p></li>
<li><p><a class="reference internal" href="#exercise-7" id="id18">Exercise 7</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#displacement-and-strain-fields" id="id19">Displacement and strain fields</a></p>
<ul>
<li><p><a class="reference internal" href="#exercise-8-optional" id="id20">Exercise 8 (Optional)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#principal-strains-and-strain-invariants" id="id21">Principal strains and strain invariants</a></p>
<ul>
<li><p><a class="reference internal" href="#exercise-9" id="id22">Exercise 9</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#strain-rate" id="id23">Strain rate</a></p></li>
<li><p><a class="reference internal" href="#finite-strain" id="id24">Finite strain</a></p>
<ul>
<li><p><a class="reference internal" href="#exercise-10-advanced" id="id25">Exercise 10 (Advanced)</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import packages for notebook here</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<p>Do not alter this cell. LaTeX commands for frequently used terms.</p>
<div class="math notranslate nohighlight">
\[\newcommand{\tensor}[1]{\underline{\underline{\mathbf{#1}}}}\]</div>
<div class="math notranslate nohighlight">
\[\newcommand{\vector}[1]{\mathbf{#1}}\]</div>
<div class="math notranslate nohighlight">
\[\newcommand{\matrix}[1]{\mathbf{#1}}\]</div>
<div class="math notranslate nohighlight">
\[\newcommand{\det}[1]{\mathrm{det}\left(#1\right)}\]</div>
<div class="math notranslate nohighlight">
\[\newcommand{\ex}{\vector{\hat{e}}_1}\]</div>
<div class="math notranslate nohighlight">
\[\newcommand{\ey}{\vector{\hat{e}}_2}\]</div>
<div class="math notranslate nohighlight">
\[\newcommand{\ez}{\vector{\hat{e}}_3}\]</div>
<div class="math notranslate nohighlight">
\[\newcommand{\nhat}{\vector{\hat{n}}}\]</div>
<div class="math notranslate nohighlight">
\[\newcommand{\ehat}{\vector{\hat{e}}}\]</div>
<div class="math notranslate nohighlight">
\[\newcommand{\xhat}{\vector{\hat{x}}}\]</div>
<div class="math notranslate nohighlight">
\[\newcommand{\x}{\vector{x}}\]</div>
<div class="math notranslate nohighlight">
\[\newcommand{\v}{\vector{v}}\]</div>
<div class="math notranslate nohighlight">
\[\newcommand{\u}{\vector{u}}\]</div>
<p>Here we define a few functions that will be helpful in this notebook thereâ€™s no need to understand these now, but you may like to look at these later if you want to extend the notebook or tackle the extension exercises.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make a position grid fine enough to represent velocities as a smooth field.</span>
<span class="k">def</span> <span class="nf">init_grid</span><span class="p">(</span><span class="n">Lx</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Ly</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

    <span class="c1"># Use 100 grid points if dx not specified</span>
    <span class="k">if</span> <span class="n">dx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="n">Lx</span><span class="o">/</span><span class="mf">100.</span>
    <span class="k">if</span> <span class="n">dy</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="n">Ly</span><span class="o">/</span><span class="mf">100.</span>
    
    <span class="c1"># Construct the grid</span>
    <span class="n">nx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="o">/</span><span class="n">dx</span><span class="p">)</span>
    <span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Lx</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
    <span class="n">ny</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="o">/</span><span class="n">dx</span><span class="p">)</span>
    <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span>

<span class="c1"># Define the initial positions of a set of tracer particles to show motion/deformation</span>
<span class="c1"># Construct two 2D numpy arrays, one for each coordinate direction. The first dimension</span>
<span class="c1"># is the particle number; the second is the time level. . .</span>
<span class="k">def</span> <span class="nf">tracers</span><span class="p">(</span><span class="n">p0</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]],</span> <span class="n">nt</span><span class="o">=</span><span class="mi">11</span><span class="p">):</span>
    
    <span class="c1"># Create arrays</span>
    <span class="n">px</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">p0</span><span class="p">),</span> <span class="n">nt</span><span class="p">))</span>
    <span class="n">py</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">px</span><span class="p">)</span>

    <span class="c1"># Initialise with specified initial coordinates.</span>
    <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p0</span><span class="p">))):</span>
        <span class="n">px</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">py</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">px</span><span class="p">,</span> <span class="n">py</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a function for plotting 2D tensor components as scalar fields. . .</span>
<span class="k">def</span> <span class="nf">plot_2D_tensor_field</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">exx</span><span class="p">,</span> <span class="n">exy</span><span class="p">,</span> <span class="n">eyx</span><span class="p">,</span> <span class="n">eyy</span><span class="p">,</span> <span class="n">cmin</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">cmax</span><span class="o">=</span><span class="mf">4.</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s1">&#39;displ&#39;</span><span class="p">):</span>
    
    <span class="c1"># same colour scale for gradients, strain components, divergence and curl</span>
    <span class="n">cc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
    
    <span class="c1"># Define colormap based on range</span>
    <span class="c1"># https://matplotlib.org/stable/tutorials/colors/colormaps.html</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">cmin</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">):</span>
        <span class="c1"># Divergent colour scale for negative and positive fields</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="s2">&quot;bwr&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Perceptually uniform sequential colormap for positive fields</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="s2">&quot;viridis&quot;</span><span class="p">)</span>

    <span class="c1"># Plot displacement gradients</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
    <span class="n">ax11</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax11</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">exx</span><span class="p">,</span> <span class="n">cc</span><span class="p">)</span>
    <span class="n">ax11</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax12</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax12</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">exy</span><span class="p">,</span> <span class="n">cc</span><span class="p">)</span>
    <span class="n">ax21</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax21</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">eyx</span><span class="p">,</span> <span class="n">cc</span><span class="p">)</span>
    <span class="n">ax21</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax22</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">dyy</span> <span class="o">=</span> <span class="n">ax22</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">eyy</span><span class="p">,</span> <span class="n">cc</span><span class="p">)</span>
    <span class="n">ax22</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">field</span> <span class="o">==</span> <span class="s1">&#39;displ&#39;</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;displacement gradients (transpose)&quot;</span><span class="p">)</span>
        <span class="n">ax11</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\partial u_x/\partial x$&#39;</span><span class="p">)</span>
        <span class="n">ax12</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\partial u_y/\partial x$&#39;</span><span class="p">)</span>
        <span class="n">ax21</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\partial u_x/\partial y$&#39;</span><span class="p">)</span>
        <span class="n">ax22</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\partial u_y/\partial y$&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">field</span> <span class="o">==</span> <span class="s1">&#39;strain&#39;</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;strain tensor&quot;</span><span class="p">)</span>
        <span class="n">ax11</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$E_</span><span class="si">{xx}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">ax12</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$E_</span><span class="si">{xy}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">ax21</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$E_</span><span class="si">{yx}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">ax22</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$E_</span><span class="si">{yy}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">field</span> <span class="o">==</span> <span class="s1">&#39;rotation&#39;</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;rotation tensor&quot;</span><span class="p">)</span>
        <span class="n">ax11</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\omega_</span><span class="si">{xx}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">ax12</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\omega_</span><span class="si">{xy}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">ax21</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\omega_</span><span class="si">{yx}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">ax22</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\omega_</span><span class="si">{yy}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">field</span> <span class="o">==</span> <span class="s1">&#39;vorticity&#39;</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;vorticity tensor&quot;</span><span class="p">)</span>
        <span class="n">ax11</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$W_</span><span class="si">{xx}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">ax12</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$W_</span><span class="si">{xy}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">ax21</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$W_</span><span class="si">{yx}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">ax22</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$W_</span><span class="si">{yy}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">field</span> <span class="o">==</span> <span class="s1">&#39;velocity&#39;</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;velocity gradients (transpose)&quot;</span><span class="p">)</span>
        <span class="n">ax11</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\partial v_x/\partial x$&#39;</span><span class="p">)</span>
        <span class="n">ax12</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\partial v_y/\partial x$&#39;</span><span class="p">)</span>
        <span class="n">ax21</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\partial v_x/\partial y$&#39;</span><span class="p">)</span>
        <span class="n">ax22</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\partial v_y/\partial y$&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">field</span> <span class="o">==</span> <span class="s1">&#39;strainrate&#39;</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;strainrate tensor&quot;</span><span class="p">)</span>
        <span class="n">ax11</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$D_</span><span class="si">{xx}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">ax12</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$D_</span><span class="si">{xy}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">ax21</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$D_</span><span class="si">{yx}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">ax22</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$D_</span><span class="si">{yy}</span><span class="s1">$&#39;</span><span class="p">)</span>
         
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

    <span class="c1">#set global colorbar</span>
    <span class="n">cb_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">dyy</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cb_ax</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="s2">&quot;viridis&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="material-vs-spatial-descriptions">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Material vs spatial descriptions</a><a class="headerlink" href="#material-vs-spatial-descriptions" title="Permalink to this heading">#</a></h2>
<p>In the lecture we introduced two alternative ways in which motion (flow or deformation) can be described: the material (Lagrangian) description or the spatial (Eulerian) description.</p>
<p>As an example, we considered the spatial description of a 2D velocity field given by:</p>
<div class="math notranslate nohighlight">
\[v_i=\frac{kx_i}{(1+kt)},\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(v_i\)</span> is the ith component of velocity,</p></li>
<li><p><span class="math notranslate nohighlight">\(k\)</span> is a constant,</p></li>
<li><p><span class="math notranslate nohighlight">\(x_i\)</span> is the ith component of the position vector,</p></li>
<li><p><span class="math notranslate nohighlight">\(t\)</span> is time.</p></li>
</ul>
<p>We then showed how to define the spatial description of acceleration in this case. We then went on to derive the corresponding material description of the displacement (path lines), velocity and acceleration of a particle in the flow.</p>
<section id="spatial-field">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Spatial field</a><a class="headerlink" href="#spatial-field" title="Permalink to this heading">#</a></h3>
<p>Letâ€™s visualise what we did using Python. We start by defining the spatial description of our velocity field as a function of <span class="math notranslate nohighlight">\(x\)</span> (<span class="math notranslate nohighlight">\(x_1\)</span>), <span class="math notranslate nohighlight">\(y\)</span> (<span class="math notranslate nohighlight">\(x_2\)</span>) and <span class="math notranslate nohighlight">\(t\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the spatial description of a 2D velocity field as a function of x, y and time.</span>
<span class="c1"># You can modify this to consider different spatial velocity functions. . . </span>
<span class="k">def</span> <span class="nf">velocity_spatial</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="o">*</span><span class="n">t</span><span class="p">),</span> <span class="n">k</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">k</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Next we initialise a grid, time array, velocity arrays and tracer arrays</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a spatial grid with 100 x 100 points. . .</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">init_grid</span><span class="p">(</span><span class="n">Lx</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span> <span class="n">Ly</span><span class="o">=</span><span class="mf">5.</span><span class="p">)</span>

<span class="c1"># Choose a time discretisation fine enough for integrating particle paths </span>
<span class="c1"># with enough precision to reproduce the analytical solution discussed in the lecture.</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">tt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">dt</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">nt</span> <span class="o">=</span> <span class="n">tt</span><span class="o">.</span><span class="n">size</span>

<span class="c1"># Define three tracers to trace the pathlines</span>
<span class="n">px</span><span class="p">,</span> <span class="n">py</span> <span class="o">=</span> <span class="n">tracers</span><span class="p">(</span><span class="n">p0</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">]],</span> <span class="n">nt</span><span class="o">=</span><span class="n">nt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can now plot the velocity vector field, the velocity magnitude scalar field and our particle positions at the intial time, ð‘¡=0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualise the velocity field at time zero</span>

<span class="c1"># Define velocity vector field and velocity magnitude scalar field</span>
<span class="n">k</span><span class="o">=</span><span class="mi">1</span>
<span class="n">vx</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="n">velocity_spatial</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
<span class="n">vmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">vx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">vy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Plot the velocity field at time zero</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Velocity magnitude &amp; Particle Positions at t = </span><span class="si">%1.1f</span><span class="s2"> s&quot;</span> <span class="o">%</span> <span class="n">tt</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>

<span class="c1"># Define a sensible fixed colorscale</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">cl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Contour plot of velocity magnitude</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">vmag</span><span class="p">,</span> <span class="n">cc</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">cl</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">left| v </span><span class="se">\\</span><span class="s2">right|$&quot;</span><span class="p">)</span>

<span class="c1"># Quiver plot of velocity vector field</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">[::</span><span class="mi">5</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="n">Y</span><span class="p">[::</span><span class="mi">5</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="n">vx</span><span class="p">[::</span><span class="mi">5</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="n">vy</span><span class="p">[::</span><span class="mi">5</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>

<span class="c1"># Marker plots of tracer particles</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">py</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;ro-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">py</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;mo-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">py</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;co-&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d013cf9cafe73a5bec05de8d98c0020f6a5ae567eac5044bad000568e1834a66.png" src="../_images/d013cf9cafe73a5bec05de8d98c0020f6a5ae567eac5044bad000568e1834a66.png" />
</div>
</div>
</section>
<section id="pathlines">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Pathlines</a><a class="headerlink" href="#pathlines" title="Permalink to this heading">#</a></h3>
<p>To visualise the particle positions at different times, we can integrate their motion using the spatial velocity field. We will use a simple approximation to do this. We can then compare the predicted particle motion with what we get by considering the material description of the same flow field.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Track the tracers in time by simple forward integration. . .</span>
<span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nt</span><span class="p">):</span>
    <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="n">velocity_spatial</span><span class="p">(</span><span class="n">px</span><span class="p">[:,</span><span class="n">it</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">py</span><span class="p">[:,</span><span class="n">it</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">tt</span><span class="p">[</span><span class="n">it</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
    <span class="n">px</span><span class="p">[:,</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">px</span><span class="p">[:,</span><span class="n">it</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">vx</span><span class="p">[:]</span> <span class="o">*</span> <span class="n">dt</span>
    <span class="n">py</span><span class="p">[:,</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">py</span><span class="p">[:,</span><span class="n">it</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">vy</span><span class="p">[:]</span> <span class="o">*</span> <span class="n">dt</span>
    
<span class="c1"># Define velocity field at last time step</span>
<span class="n">vx</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="n">velocity_spatial</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">tt</span><span class="p">[</span><span class="n">nt</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
<span class="n">vmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">vx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">vy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    
<span class="c1"># Plot the velocity field at time zero</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Velocity Magnitude &amp; Particle Trajectories at t = </span><span class="si">%1.1f</span><span class="s2"> s&quot;</span> <span class="o">%</span> <span class="n">tt</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>

<span class="c1"># Define a sensible fixed colorscale</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">cl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Contour plot of velocity magnitude</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">vmag</span><span class="p">,</span> <span class="n">cc</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">cl</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">left| v </span><span class="se">\\</span><span class="s2">right|$&quot;</span><span class="p">)</span>

<span class="c1"># Quiver plot of velocity vector field</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">[::</span><span class="mi">5</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="n">Y</span><span class="p">[::</span><span class="mi">5</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="n">vx</span><span class="p">[::</span><span class="mi">5</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="n">vy</span><span class="p">[::</span><span class="mi">5</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>

<span class="c1"># Marker plots of tracer particles, plot every 5th timestep</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px</span><span class="p">[</span><span class="mi">0</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="n">py</span><span class="p">[</span><span class="mi">0</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;ro-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px</span><span class="p">[</span><span class="mi">1</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="n">py</span><span class="p">[</span><span class="mi">1</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;mo-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px</span><span class="p">[</span><span class="mi">2</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="n">py</span><span class="p">[</span><span class="mi">2</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;co-&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/33d190477dcbde7ebe9c63ea53c0eb11d323a4bd6648c09525238e1f98034e35.png" src="../_images/33d190477dcbde7ebe9c63ea53c0eb11d323a4bd6648c09525238e1f98034e35.png" />
</div>
</div>
<p>We see from this example that each particle moves the same distance in each time interval. In other words, each particle moves at a constant velocity and experiences no acceleration <span class="math notranslate nohighlight">\(a_i = 0\)</span>.</p>
<p>Is this what we expect? In the lecture, we considered the material description of position <span class="math notranslate nohighlight">\(\x'\)</span>, by noting that the spatial velocity field is equivalent to the partial derivative of a particleâ€™s position with respect to time:</p>
<div class="math notranslate nohighlight">
\[v_i=\frac{kx_i}{(1+kt)} = \frac{\partial x_i'}{\partial t} .\]</div>
<p>Thus, by integrating with respect to time we derive the material description of position:</p>
<div class="math notranslate nohighlight">
\[x_i'(\mathbf{\xi}, t) = (1+kt)\xi_i = \xi_i + kt\xi_i \ ,\]</div>
<p>where <span class="math notranslate nohighlight">\(\xi_i\)</span> is the <span class="math notranslate nohighlight">\(i^\textrm{th}\)</span> component of the initial position of the material and <span class="math notranslate nohighlight">\(kt\xi_i\)</span> is the displacement of the particle as a function of time. As <span class="math notranslate nohighlight">\(k\)</span> is a constant, this shows that for a given initial position the particle does indeed move a constant distance in the same time (or at a constant velocity).</p>
</section>
<section id="exercise-1">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Exercise 1</a><a class="headerlink" href="#exercise-1" title="Permalink to this heading">#</a></h3>
<p>Implement this equation for the material position as a function of time in the plot above and show that it gives the same results as our numerical integration (to some numerical precision).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">material_position</span><span class="p">(</span><span class="n">xi_x</span><span class="p">,</span> <span class="n">xi_y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">k</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">xi_x</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">k</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">xi_y</span>

<span class="c1"># Define the particle position using our analytical function</span>
<span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nt</span><span class="p">):</span>
    <span class="n">px</span><span class="p">[:,</span> <span class="n">it</span><span class="p">],</span> <span class="n">py</span><span class="p">[:,</span> <span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">material_position</span><span class="p">(</span><span class="n">px</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">py</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">tt</span><span class="p">[</span><span class="n">it</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the velocity field at time zero</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Velocity Magnitude &amp; Particle Trajectories at t = </span><span class="si">%1.1f</span><span class="s2"> s&quot;</span> <span class="o">%</span> <span class="n">tt</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>

<span class="c1"># Define a sensible fixed colorscale</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">cl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Contour plot of velocity magnitude</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">vmag</span><span class="p">,</span> <span class="n">cc</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">cl</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">left| v </span><span class="se">\\</span><span class="s2">right|$&quot;</span><span class="p">)</span>

<span class="c1"># Quiver plot of velocity vector field</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">[::</span><span class="mi">5</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="n">Y</span><span class="p">[::</span><span class="mi">5</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="n">vx</span><span class="p">[::</span><span class="mi">5</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="n">vy</span><span class="p">[::</span><span class="mi">5</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>

<span class="c1"># Marker plots of tracer particles, plot every 5th timestep</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px</span><span class="p">[</span><span class="mi">0</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="n">py</span><span class="p">[</span><span class="mi">0</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;ro-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px</span><span class="p">[</span><span class="mi">1</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="n">py</span><span class="p">[</span><span class="mi">1</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;mo-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px</span><span class="p">[</span><span class="mi">2</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="n">py</span><span class="p">[</span><span class="mi">2</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;co-&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/33d190477dcbde7ebe9c63ea53c0eb11d323a4bd6648c09525238e1f98034e35.png" src="../_images/33d190477dcbde7ebe9c63ea53c0eb11d323a4bd6648c09525238e1f98034e35.png" />
</div>
</div>
</section>
<section id="relating-spatial-and-material-descriptions">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Relating spatial and material descriptions</a><a class="headerlink" href="#relating-spatial-and-material-descriptions" title="Permalink to this heading">#</a></h3>
<p>Note that the expression above tells us the position <span class="math notranslate nohighlight">\(x_i'\)</span> of a particle at time that was at the original position <span class="math notranslate nohighlight">\(\vector{\xi}\)</span>. If this expression is invertible (as it is in this case), we can rearrange it to give the initial position of a particle that is at any position <span class="math notranslate nohighlight">\(\x\)</span> in the flow at time <span class="math notranslate nohighlight">\(t\)</span>:</p>
<div class="math notranslate nohighlight">
\[\xi(\x, t) = \frac{x_i}{(1+kt)}\ .\]</div>
<p>This allows us to convert between the spatial and material description of position.</p>
</section>
<section id="exercise-2">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Exercise 2</a><a class="headerlink" href="#exercise-2" title="Permalink to this heading">#</a></h3>
<p>Letâ€™s consider a similar problem, but defined the other way round. Suppose that we know the material description of position, such that the motion of a particle of the continuum is described as:</p>
<div class="math notranslate nohighlight">
\[x' = \xi_1 + kt\xi_2 \ , \, y' = \xi_2 + kt\xi_2 \ .\]</div>
<p>Note that in this case the displacement of the particle in <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> depends only on <span class="math notranslate nohighlight">\(\xi_2\)</span> (the original <span class="math notranslate nohighlight">\(y\)</span> position).</p>
<p><strong>(a)</strong> Obtain the velocity of a particle in the material <span class="math notranslate nohighlight">\(\mathbf{v}(\mathbf{\xi}, t)\)</span> and spatial <span class="math notranslate nohighlight">\(\v(\x, t)\)</span> description.</p>
<p><strong>(b)</strong> Modify the functions above for the new spatial velocity field and material position and visualise the pathlines.</p>
<p><strong>(c)</strong> Sketch how a unit square with one corner at the origin is deformed by the field after one second and two seconds.</p>
</section>
<section id="exercise-3-optional">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">Exercise 3 (Optional)</a><a class="headerlink" href="#exercise-3-optional" title="Permalink to this heading">#</a></h3>
<p>If you are confused by the examples above and want to consider a simpler scenario to better understand these concepts, try to repeat this exercise with a simpler velocity field.</p>
<p>For example, consider the spatial description of a velocity field:</p>
<div class="math notranslate nohighlight">
\[ v_i = k \ .\]</div>
<p>In other words, the velocity field is constant everywhere; it does not depend on time or position.</p>
<p><strong>(a)</strong> Integrate this expression with respect to time to derive the material description of position with time.</p>
<p><strong>(b)</strong> Plot the velocity field and pathlines of particles in this case.</p>
</section>
<section id="exercise-4-advanced">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">Exercise 4 (Advanced)</a><a class="headerlink" href="#exercise-4-advanced" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Try a velocity field that does not lead to a zero acceleration.</p></li>
<li><p>Change initial tracer positions to get a further idea of how tracers move in different parts of the velocity field</p></li>
</ul>
</section>
<section id="time-derivative">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">Time derivative</a><a class="headerlink" href="#time-derivative" title="Permalink to this heading">#</a></h3>
<p>The time derivative of any quantity in the material description is given by:</p>
<div class="math notranslate nohighlight">
\[\frac{DP}{Dt} = \frac{\partial P}{\partial t} + \v \cdot \nabla P,\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P\)</span> is the quantity of interest, which could be a scalar, vector or tensor field;</p></li>
<li><p><span class="math notranslate nohighlight">\(\v\)</span> is the spatial description of the velocity vector field;</p></li>
<li><p><span class="math notranslate nohighlight">\(\nabla P\)</span> is the gradient of <span class="math notranslate nohighlight">\(P\)</span>.</p></li>
</ul>
<p>In the lecture, we used this expression to derive the material description of acceleration (the rate of change of velocity with time) for our example velocity field. We found that the acceleration in the material description was zero, implying that any particle in the flow experiences no acceleration, exactly as shown above.</p>
</section>
<section id="exercise-5">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">Exercise 5</a><a class="headerlink" href="#exercise-5" title="Permalink to this heading">#</a></h3>
<p>Consider the temperature field in spatial coordinates <span class="math notranslate nohighlight">\(\x\)</span> described by:</p>
<div class="math notranslate nohighlight">
\[T(\x, t) = \alpha(x + y)\]</div>
<p><strong>(a)</strong> Find the material description of temperature if a particle is moving through the temperature field according to:</p>
<div class="math notranslate nohighlight">
\[x' = \xi_1 + kt\xi_2 \ , \, y' = \xi_2 + kt\xi_2 \ ,\]</div>
<p>where <span class="math notranslate nohighlight">\(k\)</span> is a constant as before.</p>
<p><strong>(b)</strong> Determine the material time derivative of the temperature in both material and
spatial descriptions.</p>
</section>
<section id="exercise-6-optional">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">Exercise 6 (Optional)</a><a class="headerlink" href="#exercise-6-optional" title="Permalink to this heading">#</a></h3>
<p><strong>(a)</strong> For the same temperature field, find the material description of temperature if the spatial velocity field is given by:</p>
<div class="math notranslate nohighlight">
\[v_i=\frac{kx_i}{(1+kt)},\]</div>
<p>where <span class="math notranslate nohighlight">\(k\)</span> is a constant.</p>
<p><strong>(b)</strong> Determine the material time derivative of the temperature in both material and
spatial descriptions.</p>
<p><strong>(c)</strong> Modify the plotting code above to show the temperature field (rather than velocity magnitude), underneath the velocity vector field and pathlines.</p>
</section>
</section>
<section id="infinitesimal-strain">
<h2><a class="toc-backref" href="#id15" role="doc-backlink">Infinitesimal strain</a><a class="headerlink" href="#infinitesimal-strain" title="Permalink to this heading">#</a></h2>
<section id="strain-and-rotation-tensors">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">Strain and rotation tensors</a><a class="headerlink" href="#strain-and-rotation-tensors" title="Permalink to this heading">#</a></h3>
<p>In the lecture we derived the infinitesimal strain tensor <span class="math notranslate nohighlight">\(\tensor{\epsilon}\)</span>, which describes internal deformation of material in a displacement field. It is related to the displacement gradient by:</p>
<div class="math notranslate nohighlight">
\[\tensor{\epsilon} = \frac{1}{2}\left(\nabla \u + \nabla\u^T\right) ,\]</div>
<p>where the displacement gradient is defined in Cartesian coordinates as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla \u  = \frac{\partial u_j}{\partial x_i} = \left[\begin{array}{ccc}
                                \frac{\partial u_1}{\partial x_1} &amp; \frac{\partial u_2}{\partial x_1} &amp; \frac{\partial u_3}{\partial x_1} \\
                                \frac{\partial u_1}{\partial x_2} &amp; \frac{\partial u_2}{\partial x_2} &amp; \frac{\partial u_3}{\partial x_2} \\ 
                                \frac{\partial u_1}{\partial x_3} &amp; \frac{\partial u_2}{\partial x_3} &amp; \frac{\partial u_3}{\partial x_3}
                             \end{array} \right] .\end{split}\]</div>
<p>Note also that the rotation tensor <span class="math notranslate nohighlight">\(\tensor{\omega}\)</span> is defined as:</p>
<div class="math notranslate nohighlight">
\[\tensor{\omega} = \frac{1}{2}\left(\nabla \u - \nabla\u^T\right) .\]</div>
<p>The transpose displacement gradient tensor is the sum of strain and rotation tensors.</p>
<div class="math notranslate nohighlight">
\[ \nabla \u = \tensor{\epsilon} + \tensor{\omega}.\]</div>
</section>
<section id="strain-tensor-components">
<h3><a class="toc-backref" href="#id17" role="doc-backlink">Strain tensor components</a><a class="headerlink" href="#strain-tensor-components" title="Permalink to this heading">#</a></h3>
<p>Similar to the stress tensor, we can define the following results:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\tensor{\epsilon} \cdot \ex = \vector{d\ex}' = (\epsilon_{11}, \epsilon_{21}, \epsilon_{31})\)</span> is the change in the unit vector in the <span class="math notranslate nohighlight">\(x_1\)</span> direction caused by the deformation.</p></li>
<li><p><span class="math notranslate nohighlight">\(\ex \cdot \tensor{\epsilon} \cdot \ex = \epsilon_{11}\)</span> is the unit elongation in the <span class="math notranslate nohighlight">\(x_1\)</span> direction. In other words, it is the change in length in the <span class="math notranslate nohighlight">\(x_1\)</span> direction of <span class="math notranslate nohighlight">\(\ex\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\ex \cdot \tensor{\epsilon} \cdot \ey = \epsilon_{12}\)</span> is the change of the <span class="math notranslate nohighlight">\(\ey\)</span> unit vector in the <span class="math notranslate nohighlight">\(x_1\)</span> direction. Because the strain tensor is symmetric, this is the same as the change of the <span class="math notranslate nohighlight">\(\ex\)</span> unit vector in the <span class="math notranslate nohighlight">\(x_2\)</span> direction <span class="math notranslate nohighlight">\(\epsilon_{21}\)</span>. Note also that so long as the change is small, <span class="math notranslate nohighlight">\(2\epsilon_{12}\)</span> is the change in the angle of a unit square, spanned by <span class="math notranslate nohighlight">\(\ex\)</span> and <span class="math notranslate nohighlight">\(\ey\)</span>.</p></li>
</ul>
<p>More generally,</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\tensor{\epsilon}\cdot \hat{\x} = \vector{dx}'\)</span>, where the deformation of <span class="math notranslate nohighlight">\(\hat{\x}\)</span> by strain <span class="math notranslate nohighlight">\(\tensor{\epsilon}\)</span> results in the new vector <span class="math notranslate nohighlight">\(\x' = \hat{\x} + \vector{dx}'\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(\hat{\x} \cdot \tensor{\epsilon}\cdot \hat{\x} = \hat{\x} \cdot \vector{dx}'\)</span>, which is the component of the deformation <span class="math notranslate nohighlight">\(\vector{dx}'\)</span> in the direction of <span class="math notranslate nohighlight">\(\hat{\x}\)</span>.</p></li>
</ul>
</section>
<section id="exercise-7">
<h3><a class="toc-backref" href="#id18" role="doc-backlink">Exercise 7</a><a class="headerlink" href="#exercise-7" title="Permalink to this heading">#</a></h3>
<p>With reference to a rectangular Cartesian coordinate system, the state of strain at a point is given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \tensor{\epsilon} = \left[\begin{array}{rrr}
                                5 &amp; 3 &amp; 0 \\
                                3 &amp; 4 &amp; -1 \\
                                0 &amp; -1 &amp; 2
                             \end{array} \right] \times 10^{-4} \ .\end{split}\]</div>
<p><strong>(a)</strong> What is the unit elongation (change in length divided by original length) in the direction of <span class="math notranslate nohighlight">\(2\ex + 2\ey + \ez\)</span>?</p>
<p><strong>(b)</strong> What is the change in angle between two vectors emanating from a point in the directions <span class="math notranslate nohighlight">\(2\ex + 2\ey + \ez\)</span> and <span class="math notranslate nohighlight">\(3\ex - 6\ez\)</span>, which are perperpendicular prior to deformation?</p>
</section>
</section>
<section id="displacement-and-strain-fields">
<h2><a class="toc-backref" href="#id19" role="doc-backlink">Displacement and strain fields</a><a class="headerlink" href="#displacement-and-strain-fields" title="Permalink to this heading">#</a></h2>
<p>In the lecture, we considered an example displacement field to develop our insight into strain.</p>
<p>We considered the displacement field: <span class="math notranslate nohighlight">\(u_x = 0.1x^2, \, u_y = 0.4xy\)</span>. Letâ€™s have a look at this field.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s define our displacement field. . .</span>
<span class="k">def</span> <span class="nf">displacement_spatial</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">k1</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">k2</span><span class="o">=</span><span class="mf">0.4</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">k1</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">k2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualise the displacement field </span>
<span class="c1"># Define a grid, displacement vector field and displacement magnitude scalar field</span>
<span class="n">k1</span><span class="o">=</span><span class="mf">0.1</span><span class="p">;</span> <span class="n">k2</span><span class="o">=</span><span class="mf">0.4</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">init_grid</span><span class="p">()</span>
<span class="n">ux</span><span class="p">,</span> <span class="n">uy</span> <span class="o">=</span> <span class="n">displacement_spatial</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">k1</span><span class="o">=</span><span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="o">=</span><span class="n">k2</span><span class="p">)</span>
<span class="n">umag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ux</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">uy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Plot the fields</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">umag</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">],</span> <span class="n">Y</span><span class="p">[</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">],</span> <span class="n">ux</span><span class="p">[</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">],</span> <span class="n">uy</span><span class="p">[</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;y&#39;)
</pre></div>
</div>
<img alt="../_images/4f7ba2c85df9e64596fb2495adfe7b2023654a8cf218c2ffacd6f584e687da7c.png" src="../_images/4f7ba2c85df9e64596fb2495adfe7b2023654a8cf218c2ffacd6f584e687da7c.png" />
</div>
</div>
<p>We see that the field is quite complex. Can you anticipate what type of deformation such a field would result in? This is what the strain tensor tells us, so letâ€™s remind ourselves of how we determine this.</p>
<p>For this field the displacement gradient tensor <span class="math notranslate nohighlight">\(\nabla \u\)</span> is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla \u =  \left[\begin{array}{cc}
                                \frac{\partial u_x}{\partial x} &amp; \frac{\partial u_y}{\partial x} \\
                                \frac{\partial u_x}{\partial y} &amp; \frac{\partial u_y}{\partial y} 
                             \end{array} \right] ,\end{split}\]</div>
<p>Which is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla \u =  \left[\begin{array}{cc}
                                0.2 x &amp; 0.4 y \\
                                0 &amp; 0.4x
                             \end{array} \right] 
~~~~or~~~~
\nabla^T \u =  \left[\begin{array}{cc}
                                0.2 x &amp; 0 \\
                                0.4y &amp; 0.4x
                             \end{array} \right].\end{split}\]</div>
<p>Letâ€™s visualise the displacement gradients for our field using a scalar field to represent each component of the <span class="math notranslate nohighlight">\(\nabla \u\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the gradient of the displacement field for our example,</span>
<span class="c1"># which we have derived by hand.</span>
<span class="c1"># You can modify this function for different displacement fields. . .</span>
<span class="k">def</span> <span class="nf">gradient_displacement</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">k1</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">k2</span><span class="o">=</span><span class="mf">0.4</span><span class="p">):</span>
    <span class="n">duxdx</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">k1</span><span class="o">*</span><span class="n">x</span>
    <span class="n">duydx</span> <span class="o">=</span> <span class="n">k2</span><span class="o">*</span><span class="n">y</span>
    <span class="n">duxdy</span> <span class="o">=</span> <span class="mi">0</span><span class="o">*</span><span class="n">x</span>
    <span class="n">duydy</span> <span class="o">=</span> <span class="n">k2</span><span class="o">*</span><span class="n">x</span>
    <span class="k">return</span> <span class="n">duxdx</span><span class="p">,</span> <span class="n">duydx</span><span class="p">,</span> <span class="n">duxdy</span><span class="p">,</span> <span class="n">duydy</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the displacement gradient component fields</span>
<span class="n">duxdx</span><span class="p">,</span> <span class="n">duydx</span><span class="p">,</span> <span class="n">duxdy</span><span class="p">,</span> <span class="n">duydy</span> <span class="o">=</span> <span class="n">gradient_displacement</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">k1</span><span class="o">=</span><span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="o">=</span><span class="n">k2</span><span class="p">)</span>

<span class="c1"># Plot the transpose displacement gradient </span>
<span class="c1"># as four separate scalar fields with the same colorscale</span>
<span class="n">plot_2D_tensor_field</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">duxdx</span><span class="p">,</span> <span class="n">duydx</span><span class="p">,</span> <span class="n">duxdy</span><span class="p">,</span> <span class="n">duydy</span><span class="p">,</span> <span class="n">cmax</span><span class="o">=</span><span class="mf">4.</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 640x480 with 0 Axes&gt;
</pre></div>
</div>
<img alt="../_images/35066db16568876d0d561c2d2fc21c7476f4b610d79a346ad68b41265a6ac830.png" src="../_images/35066db16568876d0d561c2d2fc21c7476f4b610d79a346ad68b41265a6ac830.png" />
</div>
</div>
<p>From this we see that the elongation in the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> directions increases in the <span class="math notranslate nohighlight">\(x\)</span>-direction. There is no simple shear in the <span class="math notranslate nohighlight">\(x\)</span>-directionâ€“i.e., initially vertical lines will remain vertical. The simple shear in the <span class="math notranslate nohighlight">\(y\)</span>-direction increases with <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>Armed with the displacement gradients, we can now calculate the infinitesimal strain tensor field:</p>
<div class="math notranslate nohighlight">
\[\tensor{\epsilon} = \frac{1}{2}\left(\nabla \u + \nabla\u^T\right) .\]</div>
<p>Letâ€™s visualise this in a similar way with a scalar field for each component of the tensorâ€¦</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a function for calculating the 2D strain tensor components </span>
<span class="c1"># from the displacement gradients. . .</span>
<span class="k">def</span> <span class="nf">strain_tensor_2D</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">):</span>
    
    <span class="c1"># Calculate the displacement gradients</span>
    <span class="n">duxdx</span><span class="p">,</span> <span class="n">duydx</span><span class="p">,</span> <span class="n">duxdy</span><span class="p">,</span> <span class="n">duydy</span> <span class="o">=</span> <span class="n">gradient_displacement</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">k1</span><span class="o">=</span><span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="o">=</span><span class="n">k2</span><span class="p">)</span>

    <span class="c1"># Construct the strain tensor</span>
    <span class="n">Exx</span> <span class="o">=</span> <span class="n">duxdx</span>
    <span class="n">Exy</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">duxdy</span> <span class="o">+</span> <span class="n">duydx</span><span class="p">)</span>
    <span class="n">Eyx</span> <span class="o">=</span> <span class="n">Exy</span>
    <span class="n">Eyy</span> <span class="o">=</span> <span class="n">duydy</span>
    
    <span class="k">return</span> <span class="n">Exx</span><span class="p">,</span> <span class="n">Exy</span><span class="p">,</span> <span class="n">Eyx</span><span class="p">,</span> <span class="n">Eyy</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the strain tensor component fields</span>
<span class="n">Exx</span><span class="p">,</span> <span class="n">Exy</span><span class="p">,</span> <span class="n">Eyx</span><span class="p">,</span> <span class="n">Eyy</span> <span class="o">=</span> <span class="n">strain_tensor_2D</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">)</span>

<span class="c1"># Plot the displacement gradient as four separate scalar fields with the same colorscale</span>
<span class="n">plot_2D_tensor_field</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Exx</span><span class="p">,</span> <span class="n">Exy</span><span class="p">,</span> <span class="n">Eyx</span><span class="p">,</span> <span class="n">Eyy</span><span class="p">,</span> <span class="n">cmax</span><span class="o">=</span><span class="mf">4.</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s1">&#39;strain&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 640x480 with 0 Axes&gt;
</pre></div>
</div>
<img alt="../_images/bfd9bb8a23b5adc36c25b56140713cc9d2a918337a5785357157c73ec085add9.png" src="../_images/bfd9bb8a23b5adc36c25b56140713cc9d2a918337a5785357157c73ec085add9.png" />
</div>
</div>
<p>We can notice a few things:</p>
<ul class="simple">
<li><p>The diagonal components are both positive everywhere, implying that shapes will increase in area when deformed.</p></li>
<li><p>Elongation in the <span class="math notranslate nohighlight">\(y\)</span>-direction is greater than in the <span class="math notranslate nohighlight">\(x\)</span>-direction (<span class="math notranslate nohighlight">\(\epsilon_{yy} &gt; \epsilon_{xx}\)</span>).</p></li>
<li><p>Elongation in both directions increases with <span class="math notranslate nohighlight">\(x\)</span>, but is constant in <span class="math notranslate nohighlight">\(y\)</span>.</p></li>
<li><p>The strain tensor is symmetric, so the shear strains <span class="math notranslate nohighlight">\(\epsilon_{xy}\)</span> and <span class="math notranslate nohighlight">\(\epsilon_{yx}\)</span> are the same.</p></li>
</ul>
<p>With this insight, letâ€™s now look at how some simple shapes (squares) are deformed by the displacement field.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">move_tracers</span><span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="n">nt</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">k1</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">k2</span><span class="o">=</span><span class="mf">0.4</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nt</span><span class="p">):</span>
        <span class="n">uxp</span><span class="p">,</span> <span class="n">uyp</span> <span class="o">=</span> <span class="n">displacement_spatial</span><span class="p">(</span><span class="n">px</span><span class="p">[:,</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">py</span><span class="p">[:,</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">k1</span><span class="o">=</span><span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="o">=</span><span class="n">k2</span><span class="p">)</span>
        <span class="n">px</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">px</span><span class="p">[:,</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">uxp</span> <span class="o">*</span> <span class="n">dt</span>
        <span class="n">py</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">py</span><span class="p">[:,</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">uyp</span> <span class="o">*</span> <span class="n">dt</span>
    <span class="k">return</span> <span class="n">px</span><span class="p">,</span> <span class="n">py</span>

<span class="n">nt</span><span class="o">=</span><span class="mi">81</span>
<span class="c1"># Define two squares formed by five tracers (with one overlap for plotting) </span>
<span class="n">px1</span><span class="p">,</span> <span class="n">py1</span> <span class="o">=</span> <span class="n">tracers</span><span class="p">(</span><span class="n">p0</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">]],</span> <span class="n">nt</span><span class="o">=</span><span class="n">nt</span><span class="p">)</span>
<span class="n">px2</span><span class="p">,</span> <span class="n">py2</span> <span class="o">=</span> <span class="n">tracers</span><span class="p">(</span><span class="n">p0</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.6</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.2</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]],</span> <span class="n">nt</span><span class="o">=</span><span class="n">nt</span><span class="p">)</span>

<span class="c1"># Move the tracers in the displacement field for nt increments</span>
<span class="n">px1</span><span class="p">,</span> <span class="n">py1</span> <span class="o">=</span> <span class="n">move_tracers</span><span class="p">(</span><span class="n">px1</span><span class="p">,</span> <span class="n">py1</span><span class="p">,</span> <span class="mi">81</span><span class="p">)</span>
<span class="n">px2</span><span class="p">,</span> <span class="n">py2</span> <span class="o">=</span> <span class="n">move_tracers</span><span class="p">(</span><span class="n">px2</span><span class="p">,</span> <span class="n">py2</span><span class="p">,</span> <span class="mi">81</span><span class="p">)</span>

<span class="c1"># Plot the fields</span>
<span class="n">plt</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="s2">&quot;viridis&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">umag</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">],</span> <span class="n">Y</span><span class="p">[</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">],</span> <span class="n">ux</span><span class="p">[</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">],</span> <span class="n">uy</span><span class="p">[</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">],</span> 
           <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;inches&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">py1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;wo-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px1</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">py1</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ro-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">py2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;wo-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px2</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">py2</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ro-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 640x480 with 0 Axes&gt;
</pre></div>
</div>
<img alt="../_images/0186780a1f0ddf8b7822056e704c1480cfca758adb3bef0b46846517df19f770.png" src="../_images/0186780a1f0ddf8b7822056e704c1480cfca758adb3bef0b46846517df19f770.png" />
</div>
</div>
<p>Here we see that the square on the right has undergone more extension in <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> (as well as more translation), but has been sheared slightly less in the <span class="math notranslate nohighlight">\(y\)</span> direction. The sides of the square that were vertical have not been rotated, while the initially horizontal sides have been rotated.</p>
<p>We can also plot the pathlines of the corner points to visualise the stages of deformation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the tracer positions vs time. . .</span>
<span class="n">plt</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="s2">&quot;viridis&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">umag</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">],</span> <span class="n">Y</span><span class="p">[</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">],</span> <span class="n">ux</span><span class="p">[</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">],</span> <span class="n">uy</span><span class="p">[</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">],</span> 
           <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;inches&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px1</span><span class="p">[:,::</span><span class="mi">10</span><span class="p">],</span> <span class="n">py1</span><span class="p">[:,::</span><span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px1</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">py1</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ro-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px2</span><span class="p">[:,::</span><span class="mi">10</span><span class="p">],</span> <span class="n">py2</span><span class="p">[:,::</span><span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;co&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px2</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">py2</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;co-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 640x480 with 0 Axes&gt;
</pre></div>
</div>
<img alt="../_images/c5d4742514e76342981c1255a45a5586421ef7337c466b4fdff31d84b1e652a0.png" src="../_images/c5d4742514e76342981c1255a45a5586421ef7337c466b4fdff31d84b1e652a0.png" />
</div>
</div>
<p>We can also visualise the rotation tensor in a similar way.</p>
<p>Recall that the rotation tensor in 2D Cartesian coordinates is given by:</p>
<div class="math notranslate nohighlight">
\[\tensor{\omega} = \frac{1}{2}\left(\nabla \u - \nabla\u^T\right) .\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a function for calculating the 2D rotation tensor components </span>
<span class="c1"># from the displacement gradients. . .</span>
<span class="k">def</span> <span class="nf">rotation_tensor_2D</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">):</span>
    
    <span class="c1"># Calculate the displacement gradients</span>
    <span class="n">duxdx</span><span class="p">,</span> <span class="n">duydx</span><span class="p">,</span> <span class="n">duxdy</span><span class="p">,</span> <span class="n">duydy</span> <span class="o">=</span> <span class="n">gradient_displacement</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">k1</span><span class="o">=</span><span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="o">=</span><span class="n">k2</span><span class="p">)</span>

    <span class="c1"># Construct the strain tensor</span>
    <span class="n">Wxx</span> <span class="o">=</span> <span class="mf">0.</span><span class="o">*</span><span class="n">x</span>
    <span class="n">Wxy</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">duydx</span> <span class="o">-</span> <span class="n">duxdy</span><span class="p">)</span>
    <span class="n">Wyx</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">duxdy</span> <span class="o">-</span> <span class="n">duydx</span><span class="p">)</span>
    <span class="n">Wyy</span> <span class="o">=</span> <span class="mf">0.</span><span class="o">*</span><span class="n">x</span>
    
    <span class="k">return</span> <span class="n">Wxx</span><span class="p">,</span> <span class="n">Wxy</span><span class="p">,</span> <span class="n">Wyx</span><span class="p">,</span> <span class="n">Wyy</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the strain tensor component fields</span>
<span class="n">Wxx</span><span class="p">,</span> <span class="n">Wxy</span><span class="p">,</span> <span class="n">Wyx</span><span class="p">,</span> <span class="n">Wyy</span> <span class="o">=</span> <span class="n">rotation_tensor_2D</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">)</span>

<span class="c1"># Plot the displacement gradient as four separate scalar fields with the same colorscale</span>
<span class="n">plot_2D_tensor_field</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Wxx</span><span class="p">,</span> <span class="n">Wxy</span><span class="p">,</span> <span class="n">Wyx</span><span class="p">,</span> <span class="n">Wyy</span><span class="p">,</span> <span class="n">cmin</span><span class="o">=-</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">cmax</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s1">&#39;rotation&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 640x480 with 0 Axes&gt;
</pre></div>
</div>
<img alt="../_images/e03e6b95194862b9b0990edf35cd8e7845973cb190dccb018e783c5a61a52794.png" src="../_images/e03e6b95194862b9b0990edf35cd8e7845973cb190dccb018e783c5a61a52794.png" />
</div>
</div>
<section id="exercise-8-optional">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">Exercise 8 (Optional)</a><a class="headerlink" href="#exercise-8-optional" title="Permalink to this heading">#</a></h3>
<p>If you find the example above too complicated and/or you would like to develop more intuition about the deformation described by different displacement fields and strain tensors, you might like to implement different <code class="docutils literal notranslate"><span class="pre">displacement_spatial</span></code> functions and their corresponding <code class="docutils literal notranslate"><span class="pre">gradient_displacement</span></code> function, which you will have to work out by hand.</p>
<p>Some displacement fields you might analyse, in order of complexity are:</p>
<p>Pure translation:
$<span class="math notranslate nohighlight">\(u_x = k_1, \, u_y = k_2\)</span>$</p>
<p>Pure rotation:
$<span class="math notranslate nohighlight">\(u_x = k_1y, \, u_y = -k_2x\)</span>$</p>
<p>Pure shear:
$<span class="math notranslate nohighlight">\(u_x = k_1x, \, u_y = -k_2y\)</span>$</p>
</section>
</section>
<section id="principal-strains-and-strain-invariants">
<h2><a class="toc-backref" href="#id21" role="doc-backlink">Principal strains and strain invariants</a><a class="headerlink" href="#principal-strains-and-strain-invariants" title="Permalink to this heading">#</a></h2>
<p>As with the stress tensor, we can define a rotated coordinate system in which the strain tensor is diagonalâ€“i.e., all off-diagonal components are zero. The diagonal components of this tensor are the <em>principal</em> strains (maximum, minimum and intermediate fractional length changes) and the corresponding coordinate directions are the principal strain directions.</p>
<p>To find the principal strains and associated directions we need to solve the eigenvalue problem for the strain tensor.</p>
<p>We can also define measures of strain that are invariant to the coordinate system. For example, the trace of the strain tensor (the sum of the diagonal components) is the volume change associated with the deformation.</p>
<div class="math notranslate nohighlight">
\[ \mathrm{tr}(\tensor{\epsilon}) = \theta = \epsilon_{ii} .\]</div>
<p>Finally, we can separate the total strain tensor into an isotropic and deviatoric part:</p>
<div class="math notranslate nohighlight">
\[\epsilon_{ij} = \frac{\theta}{3}\delta_{ij} + \epsilon_{ij}' .\]</div>
<p>where <span class="math notranslate nohighlight">\(\epsilon_{ij}'\)</span> is known as the deviatoric strain. The isotropic part describes volume change only; the deviatoric part describes change in shape only and involves no change in volume.</p>
<section id="exercise-9">
<h3><a class="toc-backref" href="#id22" role="doc-backlink">Exercise 9</a><a class="headerlink" href="#exercise-9" title="Permalink to this heading">#</a></h3>
<p>For the displacement field <span class="math notranslate nohighlight">\(u_1 = k\xi_1^2, \, u_2 = k\xi_2\xi_3, \, u_3 = k(2\xi_1\xi_3 + \xi_1^2)\)</span> and <span class="math notranslate nohighlight">\(k = 10^{-6}\)</span>, find:</p>
<p><strong>(a)</strong> the infinitesimal strain tensor <span class="math notranslate nohighlight">\(\tensor{\epsilon}\)</span></p>
<p><strong>(Advanced)</strong></p>
<p><strong>(b)</strong> the <em>maximum</em> unit elongation for an element initially at <span class="math notranslate nohighlight">\(\xi = (1, 0, 0)\)</span>.</p>
</section>
</section>
<section id="strain-rate">
<h2><a class="toc-backref" href="#id23" role="doc-backlink">Strain rate</a><a class="headerlink" href="#strain-rate" title="Permalink to this heading">#</a></h2>
<p>In similar way as for the strain tensor, a tensor that describes the rate of change of deformation can be defined from the velocity gradient:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla \v  = \frac{\partial v_i}{\partial x_j} = \left[\begin{array}{ccc}
                                \frac{\partial v_1}{\partial x_1} &amp; \frac{\partial v_2}{\partial x_1} &amp; \frac{\partial v_3}{\partial x_1} \\
                                \frac{\partial v_1}{\partial x_2} &amp; \frac{\partial v_2}{\partial x_2} &amp; \frac{\partial v_3}{\partial x_2} \\ 
                                \frac{\partial v_1}{\partial x_3} &amp; \frac{\partial v_2}{\partial x_3} &amp; \frac{\partial v_3}{\partial x_3}
                             \end{array} \right] .\end{split}\]</div>
<p>The strain rate tensor <span class="math notranslate nohighlight">\(\tensor{D}\)</span> is defined as:</p>
<div class="math notranslate nohighlight">
\[\tensor{D} = \frac{1}{2}\left(\nabla \v + \nabla\v^T\right) .\]</div>
<p>The vorticity tensor <span class="math notranslate nohighlight">\(\tensor{W}\)</span> is defined as:</p>
<div class="math notranslate nohighlight">
\[\tensor{W} = \frac{1}{2}\left(\nabla \v - \nabla\v^T\right) .\]</div>
<p>The velocity gradient tensor is the sum of strain rate and vorticity tensors.</p>
<div class="math notranslate nohighlight">
\[ \nabla \v = \tensor{D} + \tensor{W}.\]</div>
</section>
<section id="finite-strain">
<h2><a class="toc-backref" href="#id24" role="doc-backlink">Finite strain</a><a class="headerlink" href="#finite-strain" title="Permalink to this heading">#</a></h2>
<p>The <em>infinitesimal</em> strain tensor and our analysis up to this point has assumed that in any given increment of deformation, the strain is small or, equivalently, that the displacement gradient is constant over the strain increment. For non-linear displacement fields, this assumption will not be valid and so we must either apply the infinitesimal strain tensor many times in small increments to describe the deformation or use so-called <em>finite</em> strain theory, which uses fewer approximations to describe deformation.</p>
<p>Recall that the deformation of an element <span class="math notranslate nohighlight">\(\vector{dx}'\)</span> caused by a displacement field is given by:</p>
<div class="math notranslate nohighlight">
\[\vector{dx}' = \vector{dx} + \nabla{\u}\cdot\vector{dx} .\]</div>
<p>It can be shown that according to finite strain theory, the finite deformation tensor (or Lagrange strain tensor) <span class="math notranslate nohighlight">\(\tensor{E^*}\)</span> is defined as:</p>
<div class="math notranslate nohighlight">
\[\tensor{E^*} = \frac{1}{2}\left[\nabla\u + (\nabla\u)^T + (\nabla\u)^T\cdot\nabla\u\right] ,\]</div>
<p>which we note includes extra terms <span class="math notranslate nohighlight">\((\nabla\u)^T.\nabla\u\)</span> that are not part of the infinitesismal strain tensor <span class="math notranslate nohighlight">\(\tensor{E}\)</span>. As a result, the components of <span class="math notranslate nohighlight">\(\tensor{E^*}\)</span> and <span class="math notranslate nohighlight">\(\tensor{\epsilon}\)</span> will differ for large strains and have slightly different interpretations. The advanced exercise below will help build your intuition for this.</p>
<section id="exercise-10-advanced">
<h3><a class="toc-backref" href="#id25" role="doc-backlink">Exercise 10 (Advanced)</a><a class="headerlink" href="#exercise-10-advanced" title="Permalink to this heading">#</a></h3>
<p>Given the 2D displacement field: <span class="math notranslate nohighlight">\(u_1= k\xi_2^2\)</span>, <span class="math notranslate nohighlight">\(u_2=0\)</span>, where <span class="math notranslate nohighlight">\(k=10^{-4}\)</span>:</p>
<p><strong>(a)</strong> Sketch the deformation of a unit square OABC, with as corner points: <span class="math notranslate nohighlight">\(O=(0,0)\)</span>, <span class="math notranslate nohighlight">\(A=(1,0)\)</span>, <span class="math notranslate nohighlight">\(B=(1,1)\)</span>, <span class="math notranslate nohighlight">\(C(0,1)\)</span>.</p>
<p><strong>(b)</strong> Calculate <span class="math notranslate nohighlight">\(\nabla\u\)</span>, <span class="math notranslate nohighlight">\((\nabla\u)^T\)</span> and <span class="math notranslate nohighlight">\((\nabla\u)^T.\nabla\u\)</span> and therefore write down the Lagrange strain tensor <span class="math notranslate nohighlight">\(\tensor{E^*}\)</span>.</p>
<p><strong>(c)</strong> Using the displacement gradient <span class="math notranslate nohighlight">\(\nabla\u\)</span> directly (i.e., not by calculating the infinitesimal strain tensor), find the deformed vectors <span class="math notranslate nohighlight">\(\vector{dx}'^{(1)}\)</span> and <span class="math notranslate nohighlight">\(\vector{dx}'^{(2)}\)</span> of the material elements <span class="math notranslate nohighlight">\(\vector{d\xi}^{(1)} = d\xi_1\ex\)</span> and <span class="math notranslate nohighlight">\(\vector{d\xi}^{(2)} = d\xi_2\ey\)</span>, which were originally at point C(0,1).</p>
<p><strong>(d)</strong> Determine the difference between the deformed and undeformed lengths of the two elements.</p>
<p><strong>(e)</strong> Determine the change in angle between the two elements.</p>
<p><strong>(f)</strong> Obtain the infinitesimal strain tensor <span class="math notranslate nohighlight">\(\tensor{\epsilon}\)</span>.</p>
<p><strong>(g)</strong> Estimate the unit elongation for material elements <span class="math notranslate nohighlight">\(\vector{d\xi}^{(1)} = d\xi_1\ex\)</span> and <span class="math notranslate nohighlight">\(\vector{d\xi}^{(2)} = d\xi_2\ey\)</span> using the infinitesimal strain tensor <span class="math notranslate nohighlight">\(\tensor{\epsilon}\)</span>.</p>
<p><strong>(h)</strong> And also find the decrease in angle between these two elements from the strain tensor <span class="math notranslate nohighlight">\(\tensor{\epsilon}\)</span>.</p>
<p><strong>(i)</strong> Compare the answers from (g), (h) and (d), (e).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s define our displacement field. . .</span>
<span class="k">def</span> <span class="nf">displacement_spatial</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">k1</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">k2</span><span class="o">=</span><span class="mf">0.4</span><span class="p">):</span>
    <span class="c1">#Return a field of k1, k2 rather than scalars. . .</span>
    <span class="k">return</span> <span class="n">k1</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">y</span> 

<span class="c1"># Gradients are all zero everywhere</span>
<span class="k">def</span> <span class="nf">gradient_displacement</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">k1</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">k2</span><span class="o">=</span><span class="mf">0.4</span><span class="p">):</span>
    <span class="n">duxdx</span> <span class="o">=</span> <span class="mi">0</span><span class="o">*</span><span class="n">x</span>
    <span class="n">duydx</span> <span class="o">=</span> <span class="mi">0</span><span class="o">*</span><span class="n">y</span>
    <span class="n">duxdy</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">k1</span><span class="o">*</span><span class="n">y</span>
    <span class="n">duydy</span> <span class="o">=</span> <span class="mi">0</span><span class="o">*</span><span class="n">x</span>
    <span class="k">return</span> <span class="n">duxdx</span><span class="p">,</span> <span class="n">duydx</span><span class="p">,</span> <span class="n">duxdy</span><span class="p">,</span> <span class="n">duydy</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s visualise this strain field. If we use k=1.E-4, we won&#39;t see any deformation,</span>
<span class="c1"># so let&#39;s set this as 0.2 to exaggerate the effects of the deformation. . .</span>
<span class="n">k1</span><span class="o">=</span><span class="mf">0.2</span><span class="p">;</span> <span class="n">k2</span><span class="o">=</span><span class="mi">0</span>

<span class="c1"># Define the constants of the displacement field and number of strain increments</span>
<span class="n">nt</span><span class="o">=</span><span class="mi">81</span>

<span class="c1"># Define one squares formed by five tracers (with one overlap for plotting) </span>
<span class="n">px1</span><span class="p">,</span> <span class="n">py1</span> <span class="o">=</span> <span class="n">tracers</span><span class="p">(</span><span class="n">p0</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]],</span> <span class="n">nt</span><span class="o">=</span><span class="n">nt</span><span class="p">)</span>

<span class="c1"># Define the displacement field and magnitude</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">init_grid</span><span class="p">(</span><span class="n">Lx</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">Ly</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">ux</span><span class="p">,</span> <span class="n">uy</span> <span class="o">=</span> <span class="n">displacement_spatial</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">k1</span><span class="o">=</span><span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="o">=</span><span class="n">k2</span><span class="p">)</span>
<span class="n">umag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ux</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">uy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Move the tracers in the displacement field for nt increments</span>
<span class="n">px1</span><span class="p">,</span> <span class="n">py1</span> <span class="o">=</span> <span class="n">move_tracers</span><span class="p">(</span><span class="n">px1</span><span class="p">,</span> <span class="n">py1</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="n">k1</span><span class="o">=</span><span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="o">=</span><span class="n">k2</span><span class="p">)</span>

<span class="c1"># Calculate the displacement gradient component fields</span>
<span class="n">duxdx</span><span class="p">,</span> <span class="n">duydx</span><span class="p">,</span> <span class="n">duxdy</span><span class="p">,</span> <span class="n">duydy</span> <span class="o">=</span> <span class="n">gradient_displacement</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">k1</span><span class="o">=</span><span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="o">=</span><span class="n">k2</span><span class="p">)</span>

<span class="c1"># Plot the displacement gradient as four separate scalar fields with the same colorscale</span>
<span class="n">plot_2D_tensor_field</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">duxdx</span><span class="p">,</span> <span class="n">duydx</span><span class="p">,</span> <span class="n">duxdy</span><span class="p">,</span> <span class="n">duydy</span><span class="p">,</span> <span class="n">cmax</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>

<span class="c1"># Calculate the strain tensor component fields</span>
<span class="n">Exx</span><span class="p">,</span> <span class="n">Exy</span><span class="p">,</span> <span class="n">Eyx</span><span class="p">,</span> <span class="n">Eyy</span> <span class="o">=</span> <span class="n">strain_tensor_2D</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">)</span>

<span class="c1"># Plot the displacement gradient as four separate scalar fields with the same colorscale</span>
<span class="n">plot_2D_tensor_field</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Exx</span><span class="p">,</span> <span class="n">Exy</span><span class="p">,</span> <span class="n">Eyx</span><span class="p">,</span> <span class="n">Eyy</span><span class="p">,</span> <span class="n">cmax</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s1">&#39;strain&#39;</span><span class="p">)</span>

<span class="c1"># Plot the fields</span>
<span class="n">plt</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="s2">&quot;viridis&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">umag</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">],</span> <span class="n">Y</span><span class="p">[</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">],</span> <span class="n">ux</span><span class="p">[</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">],</span> <span class="n">uy</span><span class="p">[</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">::</span><span class="mi">5</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">py1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;wo-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px1</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">py1</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ro-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;y&#39;)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 640x480 with 0 Axes&gt;
</pre></div>
</div>
<img alt="../_images/3ff885503773d6c6346b6138233f59962abe7055027f441533c22cbd0b44c703.png" src="../_images/3ff885503773d6c6346b6138233f59962abe7055027f441533c22cbd0b44c703.png" />
<img alt="../_images/f7620065861012d4bd1928b2e2cb4089973b1cd1596c87a06a99368b7989581d.png" src="../_images/f7620065861012d4bd1928b2e2cb4089973b1cd1596c87a06a99368b7989581d.png" />
<img alt="../_images/c89ef66fd01b07517de16f7ebc0b194114b7c6f3b4a751ba8daa6ffff63bbf3a.png" src="../_images/c89ef66fd01b07517de16f7ebc0b194114b7c6f3b4a751ba8daa6ffff63bbf3a.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Chapter3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="Lecture%203%20-%20Kinematics.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">3.1 Kinematics   <a class="tocSkip"></p>
      </div>
    </a>
    <a class="right-next"
       href="solutions3.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Solutions</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-outcomes-a-class-tocskip">Learning outcomes  <a class="tocSkip"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#material-vs-spatial-descriptions">Material vs spatial descriptions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-field">Spatial field</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pathlines">Pathlines</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relating-spatial-and-material-descriptions">Relating spatial and material descriptions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-optional">Exercise 3 (Optional)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-advanced">Exercise 4 (Advanced)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-derivative">Time derivative</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5">Exercise 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6-optional">Exercise 6 (Optional)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#infinitesimal-strain">Infinitesimal strain</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#strain-and-rotation-tensors">Strain and rotation tensors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#strain-tensor-components">Strain tensor components</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7">Exercise 7</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#displacement-and-strain-fields">Displacement and strain fields</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-8-optional">Exercise 8 (Optional)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#principal-strains-and-strain-invariants">Principal strains and strain invariants</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-9">Exercise 9</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#strain-rate">Strain rate</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#finite-strain">Finite strain</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-advanced">Exercise 10 (Advanced)</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Imperial College London
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      Â© Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>