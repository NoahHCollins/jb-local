

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Exercises &#8212; Modelling and Numerical Methods</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Chapter1/exercises';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Solutions" href="solutions.html" />
    <link rel="prev" title="1.3 Intro to Tensors" href="Lecture%201.3%20-%20Intro%20to%20Tensors.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Modelling and Numerical Methods
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 1 - Analytical Background</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="intro.html">1. Intro to Vector/Tensor Calculus</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Lecture%201.1%20-%20Intro%20to%20Vectors.html">1.1 Continuum Mechanics and Vector Calculus</a></li>
<li class="toctree-l2"><a class="reference internal" href="Lecture%201.2%20-%20Vector%20Transformations.html">1.2 Vector Transformations  <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="Lecture%201.3%20-%20Intro%20to%20Tensors.html">1.3 Intro to Tensors</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="solutions.html">Solutions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter2/intro.html">2 Stress and Tensors</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2/Lecture%202%20-%20Stress%20and%20Tensors.html">2.1 Stress and Tensors  <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2/exercises2.html">Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2/solutions2.html">Solutions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter3/intro.html">3. Kinematics and Strain</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3/Lecture%203%20-%20Kinematics.html">3.1 Kinematics   <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3/exercises3.html">Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3/solutions3.html">Solutions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter4/intro.html">4. Conservation Equations</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter4/Lecture%204.1%20-%20Conservation%20Equations.html">4.1 Conservation Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter4/Lecture%204.2%20-%20Rheology.html">4.2 Rheology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter4/exercises4.html">Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter4/solutions4.html">Solutions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter5/intro.html">5. Dimensional Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter5/Lecture%205%20-%20Dimensions%20and%20Dimensional%20Analysis.html">5.1 Dimensions and Dimensional Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter5/Worksheet.html">Worksheet  <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter5/Solutions.html">Solutions  <a class="tocSkip"></a></a></li>

</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 2 - Numerical Solutions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter6/intro.html">6. Potential Flow</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter6/Lecture%206%20-%20Potential%20Flow.html">6.1 Potential Flow  <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter6/Worksheet.html">Worksheet  <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter6/Solutions.html">Solutions  <a class="tocSkip"></a></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter7/intro.html">7. Navier-Stokes</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter7/Lecture%207.1%20-%20Navier-Stokes.html">7.1 Solving Navier-Stokes Numerically</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter7/Worksheet.html">Worksheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter7/SolversIntro.html">Solvers</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter8/intro.html">8. Turbulence and Non-Newtonian Flows</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter8/Lecture%208.1%20-%20Turbulent%20and%20Non-Newtonian%20Flows.html">8.1 Turbulent and Non-Newtonian Flows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter8/Worksheet.html">Worksheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter8/Solutions.html">Solutions</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 3 - Numerical Techniques</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter9/intro.html">9. Interpolation Quadrature 2</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter9/Lecture%209.1%20-%20interpolation%20quadrature.html">9.1 Interpolation &amp; Quadrature 2 <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter9/Homework.html">Homework <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter9/Solutions.html">Solutions <a class="tocSkip"></a></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter10/intro.html">10. ODE Solvers 2</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter10/Lecture%2010.1%20-%20ODE%20Solver.html">10.1 ODE solvers 2 <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter10/Homework.html">Homework <a class="tocSkip"></a></a></li>

<li class="toctree-l2"><a class="reference internal" href="../Chapter10/Solutions.html">Solutions <a class="tocSkip"></a></a></li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter11/intro.html">11. PDE Solvers: Finite Difference Methods 2</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter11/Lecture%2011%20-%20PDE%20Solvers%20-%20Finite%20Difference%20Methods%202.html">11.1 PDE Solvers: Finite Difference Methods 2</a></li>

<li class="toctree-l2"><a class="reference internal" href="../Chapter11/Homework.html">Homework <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter11/Solutions.html">Solutions <a class="tocSkip"></a></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter12/intro.html">12. Finite Element Methods</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter12/Lecture%2012.1%20-%20FEM.html">12.1 Finite Element Methods <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter12/Homework.html">Homework <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter12/Solutions.html">Solutions <a class="tocSkip"></a></a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FChapter1/exercises.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Chapter1/exercises.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Exercises</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-outcomes-a-class-tocskip">Learning outcomes  <a class="tocSkip"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vector-operations">Vector Operations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scalar-dot-product">Scalar (dot) product</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vector-cross-product">Vector (cross) product</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coordinate-transformations">Coordinate Transformations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#orthonormal-bases">Orthonormal Bases</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4">Exercise 4</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vector-calculus">Vector Calculus</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5">Exercise 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6">Exercise 6</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#index-notation">Index Notation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7">Exercise 7</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-8">Exercise 8</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vector-and-tensor-calculus">Vector and Tensor Calculus</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-note-on-inner-dot-product-operations-with-tensors">A Note on Inner/Dot Product Operations with Tensors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-9">Exercise 9</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10">Exercise 10</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="exercises">
<h1><a class="toc-backref" href="#id1" role="doc-backlink">Exercises</a><a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h1>
<section id="learning-outcomes-a-class-tocskip">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Learning outcomes  <a class="tocSkip"></a><a class="headerlink" href="#learning-outcomes-a-class-tocskip" title="Permalink to this heading">#</a></h2>
<p>At the end of this session, you should be able to:</p>
<ol class="arabic simple">
<li><p>Compute vector and tensor operations by hand and using <span class="math notranslate nohighlight">\(\texttt{numpy}\)</span>.</p></li>
<li><p>Describe differences and similarities between tensors and vectors.</p></li>
<li><p>Perform transformations on basis vectors and determine whether the resulting system is orthonormal.</p></li>
<li><p>Compute the spatial derivatives, divergence, gradient and curl of scalar/vector fields, and describe their meaning.</p></li>
<li><p>Interpret and simplify matrix identities using index notation and the Einstein convention.</p></li>
</ol>
</section>
<section id="table-of-contents">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Table of Contents</a><a class="headerlink" href="#table-of-contents" title="Permalink to this heading">#</a></h2>
<nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#exercises" id="id1">Exercises</a></p>
<ul>
<li><p><a class="reference internal" href="#learning-outcomes-a-class-tocskip" id="id2">Learning outcomes  <a class="tocSkip"></a></p></li>
<li><p><a class="reference internal" href="#table-of-contents" id="id3">Table of Contents</a></p></li>
<li><p><a class="reference internal" href="#vector-operations" id="id4">Vector Operations</a></p>
<ul>
<li><p><a class="reference internal" href="#scalar-dot-product" id="id5">Scalar (dot) product</a></p></li>
<li><p><a class="reference internal" href="#vector-cross-product" id="id6">Vector (cross) product</a></p></li>
<li><p><a class="reference internal" href="#exercise-1" id="id7">Exercise 1</a></p></li>
<li><p><a class="reference internal" href="#exercise-2" id="id8">Exercise 2</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#coordinate-transformations" id="id9">Coordinate Transformations</a></p>
<ul>
<li><p><a class="reference internal" href="#orthonormal-bases" id="id10">Orthonormal Bases</a></p></li>
<li><p><a class="reference internal" href="#exercise-3" id="id11">Exercise 3</a></p></li>
<li><p><a class="reference internal" href="#exercise-4" id="id12">Exercise 4</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#vector-calculus" id="id13">Vector Calculus</a></p>
<ul>
<li><p><a class="reference internal" href="#exercise-5" id="id14">Exercise 5</a></p></li>
<li><p><a class="reference internal" href="#exercise-6" id="id15">Exercise 6</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#index-notation" id="id16">Index Notation</a></p>
<ul>
<li><p><a class="reference internal" href="#exercise-7" id="id17">Exercise 7</a></p></li>
<li><p><a class="reference internal" href="#exercise-8" id="id18">Exercise 8</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#vector-and-tensor-calculus" id="id19">Vector and Tensor Calculus</a></p>
<ul>
<li><p><a class="reference internal" href="#a-note-on-inner-dot-product-operations-with-tensors" id="id20">A Note on Inner/Dot Product Operations with Tensors</a></p></li>
<li><p><a class="reference internal" href="#exercise-9" id="id21">Exercise 9</a></p></li>
<li><p><a class="reference internal" href="#exercise-10" id="id22">Exercise 10</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%capture</span>
<span class="c1"># Installing library that allows for interactive, responsive plots</span>
<span class="c1">#%pip install ipympl</span>
<span class="c1"># Loading&#39;widget&#39; responsive plot module, N.B. you may have to change the below to %matplotlib inline if you </span>
<span class="c1"># have trouble getting this to work</span>
<span class="c1">#%matplotlib widget</span>
<span class="c1">#%precision 16</span>
<span class="o">%</span><span class="k">matplotlib</span> notebook

<span class="c1"># Importing required libraries</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d.art3d</span> <span class="kn">import</span> <span class="n">Poly3DCollection</span><span class="p">,</span> <span class="n">Line3DCollection</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<p>Do not alter this cell. LaTeX commands for frequently used terms.</p>
<div class="math notranslate nohighlight">
\[\newcommand{\tensor}[1]{\underline{\underline{\mathbf{#1}}}}\]</div>
<div class="math notranslate nohighlight">
\[\newcommand{\vector}[1]{\mathbf{#1}}\]</div>
<div class="math notranslate nohighlight">
\[\newcommand{\matrix}[1]{\mathbf{#1}}\]</div>
<div class="math notranslate nohighlight">
\[\newcommand{\det}[1]{\mathrm{det}\left(#1\right)}\]</div>
<div class="math notranslate nohighlight">
\[\newcommand{\ex}{\vector{\hat{e}}_1}\]</div>
<div class="math notranslate nohighlight">
\[\newcommand{\ey}{\vector{\hat{e}}_2}\]</div>
<div class="math notranslate nohighlight">
\[\newcommand{\ez}{\vector{\hat{e}}_3}\]</div>
<div class="math notranslate nohighlight">
\[\newcommand{\nhat}{\vector{\hat{n}}}\]</div>
<div class="math notranslate nohighlight">
\[\newcommand{\ehat}{\vector{\hat{e}}}\]</div>
<div class="math notranslate nohighlight">
\[\newcommand{\xhat}{\vector{\hat{x}}}\]</div>
<div class="math notranslate nohighlight">
\[\newcommand{\x}{\vector{x}}\]</div>
<div class="math notranslate nohighlight">
\[\newcommand{\v}{\vector{v}}\]</div>
<div class="math notranslate nohighlight">
\[\newcommand{\u}{\vector{u}}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Define x and y space</span>
<span class="k">def</span> <span class="nf">init_grid</span><span class="p">(</span><span class="n">Lx</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Ly</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

    <span class="c1"># Use 100 grid points if dx not specified</span>
    <span class="k">if</span> <span class="n">dx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="n">Lx</span><span class="o">/</span><span class="mf">100.</span>
    <span class="k">if</span> <span class="n">dy</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="n">Ly</span><span class="o">/</span><span class="mf">100.</span>
    
    <span class="c1"># Construct the grid</span>
    <span class="n">nx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="o">/</span><span class="n">dx</span><span class="p">)</span>
    <span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Lx</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
    <span class="n">ny</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="o">/</span><span class="n">dx</span><span class="p">)</span>
    <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">Ly</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span>

<span class="k">def</span> <span class="nf">plot_scalar_field</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">flabel</span><span class="o">=</span><span class="s2">&quot;$\phi$(x,y)&quot;</span><span class="p">,</span> <span class="n">contours</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="c1"># Plot the velocity field at time zero</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">header_visible</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    
    <span class="c1"># Contour plot of velocity magnitude</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">contours</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;w&#39;</span><span class="p">])</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">flabel</span><span class="p">)</span>
   
<span class="k">def</span> <span class="nf">plot_vector_field</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">flabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">contours</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="c1"># Plot the velocity field at time zero</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">);</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">header_visible</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">);</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">);</span>

    <span class="c1"># Contour plot of velocity magnitude</span>
    <span class="n">vcolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span>
    <span class="k">if</span> <span class="n">flabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">contours</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;w&#39;</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">flabel</span><span class="p">)</span>
        <span class="n">vcolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span>
    
    <span class="c1"># Plot vector arrows</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">[::</span><span class="mi">5</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="n">y</span><span class="p">[::</span><span class="mi">5</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="n">vx</span><span class="p">[::</span><span class="mi">5</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="n">vy</span><span class="p">[::</span><span class="mi">5</span><span class="p">,::</span><span class="mi">5</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">vcolor</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="vector-operations">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Vector Operations</a><a class="headerlink" href="#vector-operations" title="Permalink to this heading">#</a></h2>
<p>We will be using basic vector operations a lot in this module. In particular, you need to be intimately familiar with the scalar (dot) and vector (cross) products.</p>
<section id="scalar-dot-product">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Scalar (dot) product</a><a class="headerlink" href="#scalar-dot-product" title="Permalink to this heading">#</a></h3>
<p>The dot product of <span class="math notranslate nohighlight">\(\vector{a} = (a_1, a_2, a_3)\)</span> and <span class="math notranslate nohighlight">\(\vector{b} = (b_1, b_2, b_3)\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[ \vector{a}\cdot\vector{b} =  a_1b_1 + a_2b_2 + a_3b_3.\]</div>
<p>It can also be written in the so-called geometric form:</p>
<div class="math notranslate nohighlight">
\[ \vector{a}\cdot\vector{b} = \left|\vector{a}\right|\left|\vector{b}\right|\cos\theta,\]</div>
<p>where <span class="math notranslate nohighlight">\(\theta\)</span> is the angle between the two vectors in a right-hand sense.</p>
<p>It is worth noting the following:</p>
<ul class="simple">
<li><p>The dot product of <span class="math notranslate nohighlight">\(\vector{a}\)</span> and <span class="math notranslate nohighlight">\(\vector{b}\)</span> is maximum when they point in the same direction; minimum when they point in opposite directions and zero when the vectors are perpendicular.</p></li>
<li><p>The dot product is therefore a measure of <em>directional similarity</em> between <span class="math notranslate nohighlight">\(\vector{a}\)</span> and <span class="math notranslate nohighlight">\(\vector{b}\)</span>.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(\vector{b}\)</span> is a unit vector, we can interpret the dot product as the projection of <span class="math notranslate nohighlight">\(\vector{a}\)</span> in the direction of <span class="math notranslate nohighlight">\(\vector{b}\)</span>.</p></li>
<li><p>If both <span class="math notranslate nohighlight">\(\vector{a}\)</span> and <span class="math notranslate nohighlight">\(\vector{b}\)</span> are unit vectors, we can interpret the dot product as the directional cosine between them <span class="math notranslate nohighlight">\(\cos(\vector{\hat{a}},\vector{\hat{b}})\)</span>.</p></li>
<li><p>If neither <span class="math notranslate nohighlight">\(\vector{a}\)</span> nor <span class="math notranslate nohighlight">\(\vector{b}\)</span> are unit vectors, we can interpret the dot product as the projection of <span class="math notranslate nohighlight">\(\vector{a}\)</span> in the direction of <span class="math notranslate nohighlight">\(\vector{b}\)</span> times the magnitude of <span class="math notranslate nohighlight">\(\vector{b}\)</span> or vice-versa.</p></li>
</ul>
</section>
<section id="vector-cross-product">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Vector (cross) product</a><a class="headerlink" href="#vector-cross-product" title="Permalink to this heading">#</a></h3>
<p>The cross product of <span class="math notranslate nohighlight">\(\vector{a} = (a_1, a_2, a_3)\)</span> and <span class="math notranslate nohighlight">\(\vector{b} = (b_1, b_2, b_3)\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vector{a}\times\vector{b} = \left| \begin{array}{ccc}
\ex &amp; \ey &amp; \ez \\
a_1 &amp; a_2 &amp; a_3 \\
b_1 &amp; b_2 &amp; b_3 
\end{array}\right|
.\end{split}\]</div>
<p>In 2D the cross product simplifies to:</p>
<div class="math notranslate nohighlight">
\[\vector{a}\times\vector{b} = (a_1b_2-a_2b_1)\ez.\]</div>
<p>It can also be written in the so-called geometric form:</p>
<div class="math notranslate nohighlight">
\[ \vector{a}\times\vector{b} = \left|\vector{a}\right|\left|\vector{b}\right|\sin\theta \nhat,\]</div>
<p>where <span class="math notranslate nohighlight">\(\theta\)</span> is the angle between the two vectors in a right-hand sense and <span class="math notranslate nohighlight">\(\nhat\)</span> is a unit vector that points perpendicular to <span class="math notranslate nohighlight">\(\vector{a}\)</span> and <span class="math notranslate nohighlight">\(\vector{b}\)</span> in a right-hand sense.</p>
<p>It is worth noting the following:</p>
<ul class="simple">
<li><p>The cross product of <span class="math notranslate nohighlight">\(\vector{a}\)</span> and <span class="math notranslate nohighlight">\(\vector{b}\)</span> is maximum when they are orthogonal and zero when they are parallel or anti-parallel.</p></li>
<li><p>The cross product is therefore a measure of <em>directional dissimilarity</em> between <span class="math notranslate nohighlight">\(\vector{a}\)</span> and <span class="math notranslate nohighlight">\(\vector{b}\)</span>.</p></li>
<li><p>The magnitude of the cross product of <span class="math notranslate nohighlight">\(\vector{a}\)</span> and <span class="math notranslate nohighlight">\(\vector{b}\)</span> is equal to the area of the parallelogram spanned by the two vectors.</p></li>
<li><p>In 2D the cross product vector always points in the postitive or negative <span class="math notranslate nohighlight">\(x_3\)</span> direction (i.e., normal to the <span class="math notranslate nohighlight">\(x_1\)</span>-<span class="math notranslate nohighlight">\(x_2\)</span> plane.</p></li>
<li><p>In 3D, each component of the cross product vector is equivalent to the cross product of the projections of <span class="math notranslate nohighlight">\(\vector{a}\)</span> and <span class="math notranslate nohighlight">\(\vector{b}\)</span> onto the plane normal to that direction. For example, the <span class="math notranslate nohighlight">\(\ez\)</span> component is equivalent to the cross product of the projections of <span class="math notranslate nohighlight">\(\vector{a}\)</span> and <span class="math notranslate nohighlight">\(\vector{b}\)</span> onto the <span class="math notranslate nohighlight">\(x_1\)</span>-<span class="math notranslate nohighlight">\(x_2\)</span> plane.</p></li>
<li><p>The individual components of the cross product vector are therefore each a measure of <em>directional dissimilarity</em> between <span class="math notranslate nohighlight">\(\vector{a}\)</span> and <span class="math notranslate nohighlight">\(\vector{b}\)</span> in the plane normal to that direction. In other words, if the cross product of <span class="math notranslate nohighlight">\(\vector{a}\)</span> and <span class="math notranslate nohighlight">\(\vector{b}\)</span> has a component of zero in the <span class="math notranslate nohighlight">\(\ey\)</span> direction, for example, this implies that the projections of <span class="math notranslate nohighlight">\(\vector{a}\)</span> and <span class="math notranslate nohighlight">\(\vector{b}\)</span> onto the <span class="math notranslate nohighlight">\(x_1\)</span>-<span class="math notranslate nohighlight">\(x_3\)</span> plane are parallel.</p></li>
</ul>
</section>
<section id="exercise-1">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Exercise 1</a><a class="headerlink" href="#exercise-1" title="Permalink to this heading">#</a></h3>
<p>The following problems ask you to calculate various vector operations. If it’s been a while since you did these or they are new, have a go at calculating them by hand first. Then see if you can code up and compute them using <span class="math notranslate nohighlight">\(\texttt{numpy}\)</span>. Otherwise, you may want to skip directly to coding these operations up using <code class="docutils literal notranslate"><span class="pre">np.dot</span></code>, <code class="docutils literal notranslate"><span class="pre">np.cross</span></code> and <code class="docutils literal notranslate"><span class="pre">np.linalg.norm</span></code>.</p>
<p>Assuming</p>
<p><span class="math notranslate nohighlight">\(\vector{a} = \begin{pmatrix}2 \\ -1 \\ 4 \end{pmatrix}\)</span> and <span class="math notranslate nohighlight">\(\vector{b} = \begin{pmatrix}8 \\ 5 \\ -7 \end{pmatrix}\)</span></p>
<p>calculate:</p>
<p>a) <span class="math notranslate nohighlight">\(\left|\vector{a}\right|\)</span> and <span class="math notranslate nohighlight">\(\left|\vector{b}\right|\)</span>;</p>
<p>b) <span class="math notranslate nohighlight">\(\vector{a}\cdot\vector{b}\)</span> and the angle between <span class="math notranslate nohighlight">\(\vector{a}\)</span> and <span class="math notranslate nohighlight">\(\vector{b}\)</span>;</p>
<p>c) <span class="math notranslate nohighlight">\(\vector{a}\times\vector{b}\)</span> and the area spanned by <span class="math notranslate nohighlight">\(\vector{a}\)</span> and <span class="math notranslate nohighlight">\(\vector{b}\)</span>.</p>
</section>
<section id="exercise-2">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Exercise 2</a><a class="headerlink" href="#exercise-2" title="Permalink to this heading">#</a></h3>
<p>a) What steps would be required to determine in a code whether two 2D vectors, <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>, are linearly independent or not? Write them out.</p>
<p>b) How would you find components of a 3D vector <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> normal and parallel to 3D vector <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>?</p>
<p>c) Plot up different assumed <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> vectors and test the identities derived above.
</font></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">setup_figure</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.</span><span class="p">):</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figaspect</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="c1">#fig.canvas.header_visible = False</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="c1"># Add axis labels</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$e_1$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$e_2$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;$e_3$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="n">scale</span><span class="p">,</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="n">scale</span><span class="p">,</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="o">-</span><span class="n">scale</span><span class="p">,</span><span class="n">scale</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>

<span class="k">def</span> <span class="nf">add_points</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">clr</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">lbl</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">clr</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">lbl</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">add_lines</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">clr</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot3D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">11</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">11</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="mi">11</span><span class="p">),</span> <span class="n">clr</span><span class="p">);</span>
    
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.5</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.6</span><span class="p">,</span><span class="o">-</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.1</span><span class="p">])</span>

<span class="c1"># Start figure</span>
<span class="n">ax</span><span class="o">=</span><span class="n">setup_figure</span><span class="p">()</span>

<span class="c1"># Plot vectors</span>
<span class="n">add_points</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">clr</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">lbl</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">add_points</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">clr</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">lbl</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">add_lines</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">a</span><span class="p">[:],</span><span class="n">clr</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">add_lines</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">b</span><span class="p">[:],</span><span class="n">clr</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>

<span class="c1"># Calculate and plot components of a that are parallel and perpendicular to b</span>
<span class="c1"># There are parameters for two different ways of calculating each component</span>
<span class="n">a_par_b1</span><span class="o">=</span> 
<span class="n">a_par_b2</span><span class="o">=</span>
<span class="n">add_lines</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">a_par_b1</span><span class="p">[:],</span><span class="n">clr</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">add_lines</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">a_par_b2</span><span class="p">[:],</span><span class="n">clr</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">)</span>
<span class="n">a_perp_b1</span><span class="o">=</span>
<span class="n">a_perp_b2</span><span class="o">=</span>
<span class="n">add_lines</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">a_perp_b1</span><span class="p">[:],</span><span class="n">clr</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">add_lines</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">a_perp_b2</span><span class="p">[:],</span><span class="n">clr</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span>  <span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">line</span> <span class="mi">35</span>
    <span class="n">a_par_b1</span><span class="o">=</span>
              <span class="o">^</span>
<span class="ne">SyntaxError</span>: invalid syntax
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="coordinate-transformations">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Coordinate Transformations</a><a class="headerlink" href="#coordinate-transformations" title="Permalink to this heading">#</a></h2>
<p>Coordinate transformations underpin many of the key numerical methods used in scientific computing, such as Singular Value Decomposition for the solution of linear inverse problems, and Principal Component Analysis, which is used for dimensionality reduction across a huge range of Data Science applications.</p>
<p>In the lecture we focused on defining coordinate transformations in Cartesian <em>orthonormal</em> bases and this will remain the focus here. To recap, an orthonormal basis is a set of basis vectors that are mutually orthogonal and have a magnitude of 1 (i.e., they are each unit vectors).</p>
<section id="orthonormal-bases">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">Orthonormal Bases</a><a class="headerlink" href="#orthonormal-bases" title="Permalink to this heading">#</a></h3>
<p>Orthonormal bases have several important properties. For example, reflection or rotation of an orthonormal basis in any real, <em>n</em>-dimensional coordinate space will generate another orthonormal basis. In fact, every possible orthonormal basis in a given coordinate space can be obtained by applying some combination of these transformations to the original basis.</p>
<p>Another key feature is that using an orthonormal basis makes it simpler to work out the linear combination of basis vectors that represents a given vector in the coordinate space. For example, imagine <span class="math notranslate nohighlight">\(\textbf{v}_1\)</span>, <span class="math notranslate nohighlight">\(\textbf{v}_2\)</span> and <span class="math notranslate nohighlight">\(\textbf{v}_3\)</span> are a set of basis vectors for a real 3D space, we can express any vector in the space (i.e., <span class="math notranslate nohighlight">\(\textbf{v}\in\mathbb{R}^3\)</span>) using,
<span class="math notranslate nohighlight">\(\textbf{v} = x_1\textbf{v}_1 + x_2\textbf{v}_2 + x_3\textbf{v}_3\)</span>, where <span class="math notranslate nohighlight">\(x_1, x_2, x_3 \in \mathbb{R}\)</span>. If the basis is not orthonormal, although we know that appropriate <span class="math notranslate nohighlight">\(x_i\)</span> coefficients must exist, we have no way of calculating them without solving a relatively complex system of equations. By contrast, if the basis is orthonormal, determining the values of <span class="math notranslate nohighlight">\(x_i\)</span> becomes straightforward since the identity <span class="math notranslate nohighlight">\(x_i = \sum^3_i \textbf{v} \cdot \textbf{v}_i\)</span> holds.</p>
</section>
<section id="exercise-3">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">Exercise 3</a><a class="headerlink" href="#exercise-3" title="Permalink to this heading">#</a></h3>
<p>Let <span class="math notranslate nohighlight">\(\hat{\mathbf{e}}_1\)</span>, <span class="math notranslate nohighlight">\(\hat{\mathbf{e}}_2\)</span>, <span class="math notranslate nohighlight">\(\hat{\mathbf{e}}_3\)</span> be the set of standard orthonormal base vectors. We then define a new right-handed coordinate system by <span class="math notranslate nohighlight">\(\hat{\mathbf{e}}^\prime_1\)</span>, <span class="math notranslate nohighlight">\(\hat{\mathbf{e}}^\prime_2\)</span>, <span class="math notranslate nohighlight">\(\hat{\mathbf{e}}^\prime_3\)</span> where:</p>
<p><span class="math notranslate nohighlight">\(\hat{\mathbf{e}}^\prime_1 = \frac{1}{3}\left(2\hat{\mathbf{e}}_1 + 2\hat{\mathbf{e}}_2+\hat{\mathbf{e}}_3 \right)\)</span>,</p>
<p><span class="math notranslate nohighlight">\(\hat{\mathbf{e}}^\prime_2 = \frac{1}{\sqrt{2}}\left(\hat{\mathbf{e}}_1- \hat{\mathbf{e}}_2\right)\)</span>,</p>
<p><span class="math notranslate nohighlight">\(\hat{\mathbf{e}}^\prime_3 = \frac{1}{3\sqrt{2}}\left(\hat{\mathbf{e}}_1 + \hat{\mathbf{e}}_2-4\hat{\mathbf{e}}_3\right)\)</span>.</p>
<p>a) Plot up the original and transformed basis vectors using Python.</p>
<p><em>NB - some plotting functions are already provided to help you on your way.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Construct arrays for original basis</span>
<span class="n">e1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">e2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">e3</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Construct arrays for transformed basis</span>
<span class="n">e1_prime</span> <span class="o">=</span> 
<span class="n">e2_prime</span> <span class="o">=</span> 
<span class="n">e3_prime</span> <span class="o">=</span> 

<span class="c1"># Construct 3D arrays containing basis vectors</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">e1</span><span class="p">,</span><span class="n">e2</span><span class="p">,</span><span class="n">e3</span><span class="p">))</span> 
<span class="n">m_prime</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">e1_prime</span><span class="p">,</span><span class="n">e2_prime</span><span class="p">,</span><span class="n">e3_prime</span><span class="p">))</span>
<span class="c1"># N.B. m and m_prime are arrays of (x,y,z) coordinate triplets</span>

<span class="c1"># Start figure</span>
<span class="n">ax</span><span class="o">=</span><span class="n">setup_figure</span><span class="p">()</span>

<span class="c1"># Define labels</span>
<span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;$\hat{\mathbf</span><span class="si">{e}</span><span class="s1">}_1$&#39;</span><span class="p">,</span> <span class="s1">&#39;$\hat{\mathbf</span><span class="si">{e}</span><span class="s1">}_2$&#39;</span><span class="p">,</span> <span class="s1">&#39;$\hat{\mathbf</span><span class="si">{e}</span><span class="s1">}_3$&#39;</span><span class="p">]</span>
<span class="n">labels_prime</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;$\hat{\mathbf</span><span class="si">{e}</span><span class="s1">}^{\prime}_1$&#39;</span><span class="p">,</span> <span class="s1">&#39;$\hat{\mathbf</span><span class="si">{e}</span><span class="s1">}^{\prime}_2$&#39;</span><span class="p">,</span> <span class="s1">&#39;$\hat{\mathbf</span><span class="si">{e}</span><span class="s1">}^{\prime}_3$&#39;</span><span class="p">]</span>

<span class="c1"># Loop through dimensions and plot vectors</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)):</span>
  <span class="n">add_points</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">clr</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">lbl</span><span class="o">=</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
  <span class="n">add_points</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">m_prime</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">m_prime</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">m_prime</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">clr</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">lbl</span><span class="o">=</span><span class="n">labels_prime</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
  <span class="n">add_lines</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span><span class="n">clr</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
  <span class="n">add_lines</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">m_prime</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span><span class="n">clr</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>b) Is <span class="math notranslate nohighlight">\(\hat{\mathbf{e}}^\prime_1 \cdot \hat{\mathbf{e}}^\prime_2 = 0\)</span>?</p>
<p>c) Is <span class="math notranslate nohighlight">\(\hat{\mathbf{e}}^\prime_1 = \hat{\mathbf{e}}^\prime_2 \times \hat{\mathbf{e}}^\prime_3\)</span>?</p>
<p>d) Based on these answers is the new basis orthonormal?</p>
<p>e) Determine the direction cosines of the transformation that maps a vector <span class="math notranslate nohighlight">\(\vector{v}\)</span> in the <span class="math notranslate nohighlight">\(\hat{\mathbf{e}}\)</span> basis to the same vector <span class="math notranslate nohighlight">\(\vector{v}^\prime\)</span> as defined in the <span class="math notranslate nohighlight">\(\hat{\mathbf{e}}^\prime\)</span> basis, then write out the transformation matrix. Note this is the <strong>inverse</strong> of the matrix that transforms the old basis vectors <span class="math notranslate nohighlight">\(\hat{\mathbf{e}}_i\)</span> to the new basis vectors <span class="math notranslate nohighlight">\(\hat{\mathbf{e}}^\prime_i\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check orthonormality of basis vectors</span>
<span class="c1"># First check vector directionality</span>
<span class="c1"># b) Dot product identity</span>
<span class="n">dp</span> <span class="o">=</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;b) Dot product is:&#39;</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;This is effectively zero: &#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">dp</span><span class="p">))</span>

<span class="c1"># c) Cross product identity</span>
<span class="n">cp</span> <span class="o">=</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;c) Cross product minus $e^{\prime}_3$ is:&#39;</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;This is effectively zero: &#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">dp</span><span class="p">))</span>

<span class="c1"># d)  Next check vector magnitude</span>
<span class="n">mag_e1</span> <span class="o">=</span> 
<span class="n">mag_e2</span> <span class="o">=</span> 
<span class="n">mag_e3</span> <span class="o">=</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;d) Vector magnitudes are:&#39;</span><span class="p">,</span><span class="n">mag_e1</span><span class="p">,</span><span class="n">mag_e2</span><span class="p">,</span><span class="n">mag_e3</span><span class="p">)</span> 
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;These are effectively equal to one:&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">mag_e1</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">mag_e2</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">mag_e3</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Therefore, based on direction and magnitude information, basis orthonormal!&#39;</span><span class="p">)</span>

<span class="c1"># e) Determine transformation matrix</span>
<span class="c1"># First create matrices incorporating the three original basis vectors and the three transformed vectors, respectively</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">e1</span><span class="p">,</span><span class="n">e2</span><span class="p">,</span><span class="n">e3</span><span class="p">))</span>
<span class="n">m_prime</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">e1_prime</span><span class="p">,</span><span class="n">e2_prime</span><span class="p">,</span><span class="n">e3_prime</span><span class="p">))</span> 

<span class="c1"># Use the correct identity to determine the transformation matrix from the two matrices</span>
<span class="n">T</span> <span class="o">=</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;e) Transformation matrix is &#39;</span><span class="p">,</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-4">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">Exercise 4</a><a class="headerlink" href="#exercise-4" title="Permalink to this heading">#</a></h3>
<p>Plot what happens to a unit cube when transformed into the new basis defined in Exercise 3. What kind of transformation does the change of basis represent?</p>
<p><em>NB - The code to plot the faces of a unit cube are already provided.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Start figure</span>
<span class="k">def</span> <span class="nf">plot_3D_faces</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">faceclr</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span><span class="n">edgeclr</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">):</span>
    <span class="c1"># plot vertices</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter3D</span><span class="p">(</span><span class="n">Z</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Z</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">Z</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span>

    <span class="c1"># list of polygon faces</span>
    <span class="n">verts</span> <span class="o">=</span> <span class="p">[[</span><span class="n">Z</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span>
     <span class="p">[</span><span class="n">Z</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="mi">7</span><span class="p">]],</span> 
     <span class="p">[</span><span class="n">Z</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="mi">4</span><span class="p">]],</span> 
     <span class="p">[</span><span class="n">Z</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="mi">6</span><span class="p">]],</span> 
     <span class="p">[</span><span class="n">Z</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="mi">5</span><span class="p">]],</span>
     <span class="p">[</span><span class="n">Z</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="mi">0</span><span class="p">]]]</span>

    <span class="c1"># plot sides</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_collection3d</span><span class="p">(</span><span class="n">Poly3DCollection</span><span class="p">(</span><span class="n">verts</span><span class="p">,</span> 
     <span class="n">facecolors</span><span class="o">=</span><span class="n">faceclr</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="n">edgeclr</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">opacity</span><span class="p">))</span>

<span class="n">ax</span><span class="o">=</span><span class="n">setup_figure</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">2.</span><span class="p">)</span>

<span class="c1"># Create array of cube vertices</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">],</span>
                  <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                  <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                  <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span>
                  <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                  <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

<span class="c1"># Plot the faces of the cube </span>
<span class="n">plot_3D_faces</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span><span class="n">faceclr</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span><span class="n">edgeclr</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="c1"># Create array of vertices defining the 8 faces of the transformed cube (8x3 matrix)</span>
<span class="n">Z_prime</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span> 
    <span class="n">Z_prime</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> 

<span class="n">plot_3D_faces</span><span class="p">(</span><span class="n">Z_prime</span><span class="p">,</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span><span class="n">faceclr</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="n">edgeclr</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="vector-calculus">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">Vector Calculus</a><a class="headerlink" href="#vector-calculus" title="Permalink to this heading">#</a></h2>
<p>Vector calculus is the mathematics that allows us to describe spatial variation in scalar and vector fields.</p>
<p>The <strong>gradient</strong> of a scalar field <span class="math notranslate nohighlight">\(f(\x)\)</span> is a vector field formed of the partial derivatives of the scalar field with respect to distance in the coordinate directions. In Cartesian coordinates, it is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\text{2D:} \, \nabla f = \left(\begin{array}{c}
\frac{\partial f}{\partial x_1} \\ 
\frac{\partial f}{\partial x_2} 
\end{array}
\right), \ \ \ \text{3D:} \, \nabla f = \left(\begin{array}{c}
\frac{\partial f}{\partial x_1} \\ 
\frac{\partial f}{\partial x_2} \\
\frac{\partial f}{\partial x_3}
\end{array}
\right).\end{split}\]</div>
<p>The <strong>divergence</strong> of a vector field <span class="math notranslate nohighlight">\(\v(\x)\)</span> is a scalar field formed from some of the partial derivatives of the vector field with respect to distance in the coordinate directions. In Cartesian coordinates, divergence is defined as:</p>
<div class="math notranslate nohighlight">
\[\text{2D:} \, \nabla \cdot \v = \frac{\partial v_1}{\partial x_1} + \frac{\partial v_2}{\partial x_2}, \ \ \ \text{3D:} \, \nabla \cdot \v = \frac{\partial v_1}{\partial x_1} + \frac{\partial v_2}{\partial x_2} + \frac{\partial v_2}{\partial x_2}.\]</div>
<p>The <strong>curl</strong> of a vector field <span class="math notranslate nohighlight">\(\v(\x)\)</span> is a vector field formed from some of the partial derivatives of the vector field with respect to distance in the coordinate directions. In Cartesian coordinates, curl is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\text{2D:} \, \nabla \times \v = \left(\begin{array}{c}
\frac{\partial v_2}{\partial x_1} - \frac{\partial v_1}{\partial x_2} 
\end{array}
\right)\ez, \ \ \ \text{3D:} \, \nabla \times \v  = \left(\begin{array}{c}
\frac{\partial v_3}{\partial x_2} - \frac{\partial v_2}{\partial x_3} \\ 
\frac{\partial v_1}{\partial x_3} - \frac{\partial v_3}{\partial x_1} \\
\frac{\partial v_2}{\partial x_1} - \frac{\partial v_1}{\partial x_2}
\end{array}
\right).\end{split}\]</div>
<p>The following exercises are designed to familiarise you with how to calculate these derivatives and how to interpret their meaning.</p>
<section id="exercise-5">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">Exercise 5</a><a class="headerlink" href="#exercise-5" title="Permalink to this heading">#</a></h3>
<p>Consider the scalar fields:</p>
<p><span class="math notranslate nohighlight">\(~~~~~~~~\)</span> i) <span class="math notranslate nohighlight">\(\phi = x + 2y\)</span>; <span class="math notranslate nohighlight">\(~~~~~~~~\)</span> ii) <span class="math notranslate nohighlight">\(f = x^2 + 2y + xy\)</span>; <span class="math notranslate nohighlight">\(~~~~~~~~\)</span> iii) <span class="math notranslate nohighlight">\(h = \frac{0.2}{[(x+5)^2 + y^2]^{3/2}}\)</span>.</p>
<p>For each scalar field:</p>
<p>a) Plot the scalar field using the code below over the domain <span class="math notranslate nohighlight">\(-3 &lt; x &lt;3\)</span>, <span class="math notranslate nohighlight">\(-3 &lt; y &lt; 3\)</span>;</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define regular grid</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">init_grid</span><span class="p">(</span><span class="n">Lx</span><span class="o">=</span><span class="mf">3.</span><span class="p">,</span> <span class="n">Ly</span><span class="o">=</span><span class="mf">3.</span><span class="p">)</span>

<span class="c1"># Define scalar field (the first has been done for you)</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">X</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">Y</span>

<span class="c1"># Plot field</span>
<span class="n">plot_scalar_field</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">flabel</span><span class="o">=</span><span class="s2">&quot;$\phi(x,y)$&quot;</span><span class="p">,</span> <span class="n">contours</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>b) Calculate the gradient vector field;</p>
<p>c) Plot the gradient vector field superimposed on top of the scalar field, over the same domain, using the code below.</p>
<p>What do you notice about the relationship between the scalar field and the gradient vector field?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">gradient_field</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="c1"># Return the gradient of your function here</span>
    <span class="c1"># The answer for (i) has been done for you. </span>
    <span class="c1"># Note that we need to pass back the constant </span>
    <span class="c1"># components 1, 2 for every point in the field</span>
    <span class="k">return</span> <span class="mi">0</span><span class="o">*</span><span class="n">X</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">Y</span> <span class="o">+</span> <span class="mi">2</span>

<span class="c1"># Calculate gradient vector components</span>
<span class="n">gradfx</span><span class="p">,</span> <span class="n">gradfy</span> <span class="o">=</span> <span class="n">gradient_field</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>

<span class="c1"># Plot vector field on top of original scalar field</span>
<span class="n">plot_vector_field</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">gradfx</span><span class="p">,</span> <span class="n">gradfy</span><span class="p">,</span>
                  <span class="n">flabel</span><span class="o">=</span><span class="s2">&quot;$\phi(x,y)$&quot;</span><span class="p">,</span> <span class="n">contours</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-6">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">Exercise 6</a><a class="headerlink" href="#exercise-6" title="Permalink to this heading">#</a></h3>
<p>Consider the velocity vector fields:</p>
<p>i) <span class="math notranslate nohighlight">\(\mathbf{v} = \begin{bmatrix} 2 \\ -1 \\\end{bmatrix}\)</span>;</p>
<p>ii) <span class="math notranslate nohighlight">\(\mathbf{v} = \begin{bmatrix} -2y \\ 2x \\\end{bmatrix}\)</span>;</p>
<p>iii) <span class="math notranslate nohighlight">\(\mathbf{v} = \begin{bmatrix} xy \\y^2-x^2 \\\end{bmatrix}\)</span>;</p>
<p>iv) <span class="math notranslate nohighlight">\(\mathbf{v} = \begin{bmatrix} \cos\left(\frac{\pi x}{3}\right) \\  \cos\left(\frac{\pi y}{3}\right)\\\end{bmatrix}\)</span>;</p>
<p>v) <span class="math notranslate nohighlight">\(\mathbf{v} = \begin{bmatrix} \cos\left(\frac{\pi y}{3}\right) \\  \cos\left(\frac{\pi x}{3}\right)\\\end{bmatrix}\)</span>.</p>
<p>For each field:</p>
<p>a) Plot the vector field using the code below;</p>
<p>b) Calculate the divergence and curl;</p>
<p>c) Plot the vector field superimposed on (A) the divergence scalar field and (B) the <span class="math notranslate nohighlight">\(\ez\)</span> component of the curl;</p>
<p>d) What do the quantities of divergence and curl represent when applied to a velocity field?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define regular grid</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">init_grid</span><span class="p">(</span><span class="n">Lx</span><span class="o">=</span><span class="mf">3.</span><span class="p">,</span> <span class="n">Ly</span><span class="o">=</span><span class="mf">3.</span><span class="p">)</span>

<span class="c1"># Define vector field and magnitude scalar field</span>
<span class="n">vx</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="n">X</span><span class="o">*</span><span class="mi">0</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">X</span><span class="o">*</span><span class="mi">0</span> <span class="o">-</span> <span class="mi">1</span>

<span class="n">vmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">vx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">vy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Plot vector field superimposed on the magnitude of the vector field</span>
<span class="c1"># To turn off the magnitude field, remove flabel</span>
<span class="n">plot_vector_field</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">vmag</span><span class="p">,</span> <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">flabel</span><span class="o">=</span><span class="s2">&quot;|v|&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define divergence field and magnitude scalar field</span>
<span class="n">div_v</span> <span class="o">=</span> <span class="mi">0</span><span class="o">*</span><span class="n">Y</span>

<span class="n">plot_vector_field</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">div_v</span><span class="p">,</span> <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">flabel</span><span class="o">=</span><span class="s2">&quot;div(v)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate curl of field </span>
<span class="n">curl_v</span> <span class="o">=</span> <span class="mi">0</span><span class="o">*</span><span class="n">X</span>

<span class="c1"># Plot curl of field</span>
<span class="n">plot_vector_field</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">curl_v</span><span class="p">,</span> <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">flabel</span><span class="o">=</span><span class="s2">&quot;curl v&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="index-notation">
<h2><a class="toc-backref" href="#id16" role="doc-backlink">Index Notation</a><a class="headerlink" href="#index-notation" title="Permalink to this heading">#</a></h2>
<p>Index notation provides a useful shorthand for expressing vector and tensor identities that would become very cumbersome if written out in full. The key to perfoming algebraic operations using this type of notation is to keep track of the dummy and fixed indices in each case, using these to work out the number of terms and equations represented by a particular expression.</p>
<section id="exercise-7">
<h3><a class="toc-backref" href="#id17" role="doc-backlink">Exercise 7</a><a class="headerlink" href="#exercise-7" title="Permalink to this heading">#</a></h3>
<p>a) <span class="math notranslate nohighlight">\(g_k=h_k(2-3a_ib_i)-p_jq_jf_k\)</span> – In this expression which indices are dummy indices and free indices? How many equations does this expression represent and how many terms are in each?</p>
<p>b) Are the following valid expressions?</p>
<p>      i) <span class="math notranslate nohighlight">\(a_mb_s=c_m(d_r-f_r)\)</span>;</p>
<p>      ii) <span class="math notranslate nohighlight">\(x_ix_i=r^2\)</span>;</p>
<p>      iii) <span class="math notranslate nohighlight">\(a_ib_jc_j=3\)</span>.</p>
</section>
<section id="exercise-8">
<h3><a class="toc-backref" href="#id18" role="doc-backlink">Exercise 8</a><a class="headerlink" href="#exercise-8" title="Permalink to this heading">#</a></h3>
<p>a) Simplify <span class="math notranslate nohighlight">\(\delta_{ij}\delta_{jk}\delta_{kp}\delta_{pi}\)</span></p>
<p><em>Hint - Start with simplifying the product of <span class="math notranslate nohighlight">\(\delta_{kp}\delta_{pi}\)</span>.</em></p>
<p>b) Assuming n=3, show that <span class="math notranslate nohighlight">\(\epsilon_{ijk}\epsilon_{lmk} = \delta_{il}\delta_{jm}-\delta_{im}\delta_{jl}\)</span>.</p>
<p><em>Hint - Identify the free index and write three terms based on its possible values, then work out what relationships are needed between <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(l\)</span>/<span class="math notranslate nohighlight">\(m\)</span>, and <span class="math notranslate nohighlight">\(j\)</span> and <span class="math notranslate nohighlight">\(l\)</span>/<span class="math notranslate nohighlight">\(m\)</span> to generate non-zero terms.</em></p>
<p>c) Use the identity above and index notation to show that <span class="math notranslate nohighlight">\(\mathbf{a}\times\left(\mathbf{b}\times\mathbf{c}\right)=\left(\mathbf{a}\cdot\mathbf{c}\right)\mathbf{b}-\left(\mathbf{a}\cdot\mathbf{b}\right)\mathbf{c}\)</span>.</p>
<p><em>Hint - Start by using the substitution <span class="math notranslate nohighlight">\(\mathbf{v}=\mathbf{b}\times\mathbf{c}\)</span> and recall that <span class="math notranslate nohighlight">\(\left(\mathbf{a} \times \mathbf{v}\right)_i = \epsilon_{ijk} a_j v_k\)</span> and <span class="math notranslate nohighlight">\(\epsilon_{ijk}=\epsilon_{kij}\)</span>. Next express <span class="math notranslate nohighlight">\(v_k\)</span> in terms of <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{c}\)</span> using index notation and the indices <span class="math notranslate nohighlight">\(k\)</span>, <span class="math notranslate nohighlight">\(l\)</span> and <span class="math notranslate nohighlight">\(m\)</span>.</em></p>
<p><strong>Note:</strong> The derivation from (c) could also be used to derive the useful identity:</p>
<div class="math notranslate nohighlight">
\[\nabla\times(\nabla\times\v) = \nabla(\nabla\cdot\v) - {\nabla}^{2}\v \]</div>
</section>
</section>
<section id="vector-and-tensor-calculus">
<h2><a class="toc-backref" href="#id19" role="doc-backlink">Vector and Tensor Calculus</a><a class="headerlink" href="#vector-and-tensor-calculus" title="Permalink to this heading">#</a></h2>
<p>There are a range of useful algebraic operations to be aware of when manipulating systems of equations in vector and tensor form, including the dot product, cross product, tensor product and outer product. These operations can be quite work-intensive to determine by hand but are mercifully simple in Python thanks to libraries like <span class="math notranslate nohighlight">\(\texttt{numpy}\)</span>.</p>
<section id="a-note-on-inner-dot-product-operations-with-tensors">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">A Note on Inner/Dot Product Operations with Tensors</a><a class="headerlink" href="#a-note-on-inner-dot-product-operations-with-tensors" title="Permalink to this heading">#</a></h3>
<p>In the lecture notes it is mentioned that the inner/dot product of two tensors involves contraction over one index such that the expression <span class="math notranslate nohighlight">\(\mathbf{W} = \mathbf{T}\cdot\mathbf{S}\)</span>, can also be written <span class="math notranslate nohighlight">\(W_{ik} = T_{ij}S_{jk}\)</span>. The contraction in this case is over the <span class="math notranslate nohighlight">\(j\)</span> index, i.e., for a fixed value of <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(k\)</span>, all terms for different values of <span class="math notranslate nohighlight">\(j\)</span> are summed together. The full matrix expression is then:</p>
<p>$<span class="math notranslate nohighlight">\( \mathbf{W} = \begin{bmatrix} \left(T_{11}S_{11}+T_{12}S_{21}+T_{13}S_{31}\right) &amp; \left(T_{11}S_{12}+T_{12}S_{22}+T_{13}S_{32}\right) &amp; \left(T_{11}S_{13}+T_{12}S_{23}+T_{13}S_{33}\right) \\ \left(T_{21}S_{11}+T_{22}S_{21}+T_{23}S_{31}\right) &amp; \left(T_{21}S_{12}+T_{22}S_{22}+T_{23}S_{32}\right) &amp; \left(T_{21}S_{13}+T_{22}S_{23}+T_{23}S_{33}\right) \\ \left(T_{31}S_{11}+T_{32}S_{21}+T_{33}S_{31}\right) &amp; \left(T_{31}S_{12}+T_{32}S_{22}+T_{33}S_{32}\right) &amp; \left(T_{31}S_{13}+T_{32}S_{23}+T_{33}S_{33}\right) \end{bmatrix}\)</span>$.</p>
<p>As you can see this dot product operation takes two rank-2 tensors and returns a rank-2 tensor. This operation can be done for two tensors, <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{S}\)</span>, of any rank provided they share the same dimension. In such a case, the rank of the resulting tensor, <span class="math notranslate nohighlight">\(\mathbf{W}\)</span>, can be determined using <span class="math notranslate nohighlight">\(\textrm{rank}(\mathbf{W_{\cdot}}) = \textrm{rank}(\mathbf{T})+\textrm{rank}(\mathbf{S})-2\)</span>.</p>
<p>The notes on multiplication of tensors also include an expression for Hooke’s law containing the “:” symbol (i.e., <span class="math notranslate nohighlight">\(\mathbf{\sigma}=\mathbf{C}:\mathbf{\epsilon}\)</span> ). This symbol represents the <strong>double</strong> inner/dot product, which involves contraction over two indices. Since the stiffness matrix, <span class="math notranslate nohighlight">\(\mathbf{C}\)</span>, is a rank-4 tensor and strain, <span class="math notranslate nohighlight">\(\mathbf{\epsilon}\)</span>, is a rank-2 tensor, Hooke’s law can be rewritten as <span class="math notranslate nohighlight">\(\sigma_{ij} = C_{ijkl}\epsilon_{kl}\)</span>, where a contraction occurs over both the <span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(l\)</span> indices. Similarly, in the simpler case of our two rank-2 tensors <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{S}\)</span>, we can write their double dot product as <span class="math notranslate nohighlight">\(W=S_{ij}T_{ij}\)</span> where contraction occurs over both <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span>, giving:</p>
<p>$<span class="math notranslate nohighlight">\( W = \begin{bmatrix} \left(T_{11}S_{11}+T_{12}S_{12}+T_{13}S_{13}\right)+ \left(T_{21}S_{21}+T_{22}S_{22}+T_{23}S_{23}\right) + \left(T_{31}S_{31}+T_{32}S_{32}+T_{33}S_{33}\right)\end{bmatrix}\)</span>$.</p>
<p>The above double dot product operation takes two rank-2 tensors as input and returns a rank-0 tensor (i.e., a scalar). This relationship between the rank of the resulting tensor and the input tensors, <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{S}\)</span>, can be generalised in a manner similar to the standard dot product (i.e., provided dimensions of the input tensors are the same, they can be of any rank). However, in the case of the double dot product, the relationship between input and output ranks is expressed using <span class="math notranslate nohighlight">\(\textrm{rank}(\mathbf{W_{:}}) = \textrm{rank}(\mathbf{T})+\textrm{rank}(\mathbf{S})-4\)</span>. This relationship explains why the stress tensor (<span class="math notranslate nohighlight">\(\mathbf{\sigma}\)</span> in the Hooke’s law expression above is rank-2, i.e. the double dot product of a rank-4 tensor and a rank-2 tensor is a rank-2 tensor (4+2-4=2).</p>
<p>In \texttt{numpy}, <code class="docutils literal notranslate"><span class="pre">np.tensordot</span></code> calculates the double dot product of two arrays, <span class="math notranslate nohighlight">\(\mathbf{T}:\mathbf{S}\)</span>, by default (i.e., the <code class="docutils literal notranslate"><span class="pre">axes=2</span></code> flag is set automatically; <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.tensordot.html">https://numpy.org/doc/stable/reference/generated/numpy.tensordot.html</a>). However, you could use the same function to calculate the dot product, <span class="math notranslate nohighlight">\(\mathbf{T}\cdot\mathbf{S}\)</span>, by using the <code class="docutils literal notranslate"><span class="pre">axes=1</span></code> flag, or even the outer product (also known as the tensor or dyadic product), <span class="math notranslate nohighlight">\(\mathbf{T}\otimes\mathbf{S}\)</span>, using <code class="docutils literal notranslate"><span class="pre">axes=0</span></code>.</p>
</section>
<section id="exercise-9">
<h3><a class="toc-backref" href="#id21" role="doc-backlink">Exercise 9</a><a class="headerlink" href="#exercise-9" title="Permalink to this heading">#</a></h3>
<p>The following problems ask you to calculate various vector and tensor operations. Have a go at calculating them by hand first, including rewriting the expressions in index notation. Then see if you can code up and compute them using <span class="math notranslate nohighlight">\(\texttt{numpy}\)</span>.</p>
<p>Assuming</p>
<p><span class="math notranslate nohighlight">\(\mathbf{a} = \begin{pmatrix}2 \\ -1 \\ 4 \end{pmatrix}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{b} = \begin{pmatrix}8 \\ 5 \\ -7 \end{pmatrix}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{S} = \begin{bmatrix} -1 &amp; 0 &amp; 5 \\ 3 &amp; 7 &amp; 4 \\ 9 &amp; 8 &amp; 6\end{bmatrix}\)</span>, calculate:</p>
<p>a) <span class="math notranslate nohighlight">\(\textrm{tr}\left(\mathbf{S}\right)\)</span>;</p>
<p>b) <span class="math notranslate nohighlight">\(\mathbf{S}:\mathbf{S}\)</span>;</p>
<p>c) <span class="math notranslate nohighlight">\(\mathbf{S}:\mathbf{S}^T\)</span>;</p>
<p>d) <span class="math notranslate nohighlight">\(\mathbf{a}\cdot\mathbf{S}\)</span>;</p>
<p>e) <span class="math notranslate nohighlight">\(\mathbf{S}\cdot\mathbf{a}\)</span>;</p>
<p>f) <span class="math notranslate nohighlight">\(\mathbf{S}^T\cdot\mathbf{a}\)</span>;</p>
<p>g) <span class="math notranslate nohighlight">\(\mathbf{a}\otimes\mathbf{b}\)</span>;</p>
<p>h) <span class="math notranslate nohighlight">\(\mathbf{b}\otimes\mathbf{a}\)</span>.</p>
<p><em>Hint - When computing these identities with <span class="math notranslate nohighlight">\(\texttt{numpy}\)</span>, these functions will be helpful: <code class="docutils literal notranslate"><span class="pre">np.dot</span></code>, <code class="docutils literal notranslate"><span class="pre">np.outer</span></code>, <code class="docutils literal notranslate"><span class="pre">np.tensordot</span></code>, <code class="docutils literal notranslate"><span class="pre">np.trace</span></code>, and <code class="docutils literal notranslate"><span class="pre">np.transpose</span></code></em></p>
</section>
<section id="exercise-10">
<h3><a class="toc-backref" href="#id22" role="doc-backlink">Exercise 10</a><a class="headerlink" href="#exercise-10" title="Permalink to this heading">#</a></h3>
<p>Read up on the Einstein summation function <code class="docutils literal notranslate"><span class="pre">np.einsum</span></code> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.einsum.html">https://numpy.org/doc/stable/reference/generated/numpy.einsum.html</a>). Try using the index notation form of the Exercise 9 operations to recalculate the answers using <code class="docutils literal notranslate"><span class="pre">numpy.einsum</span></code>.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Chapter1"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="Lecture%201.3%20-%20Intro%20to%20Tensors.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">1.3 Intro to Tensors</p>
      </div>
    </a>
    <a class="right-next"
       href="solutions.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Solutions</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-outcomes-a-class-tocskip">Learning outcomes  <a class="tocSkip"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vector-operations">Vector Operations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scalar-dot-product">Scalar (dot) product</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vector-cross-product">Vector (cross) product</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coordinate-transformations">Coordinate Transformations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#orthonormal-bases">Orthonormal Bases</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4">Exercise 4</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vector-calculus">Vector Calculus</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5">Exercise 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6">Exercise 6</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#index-notation">Index Notation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7">Exercise 7</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-8">Exercise 8</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vector-and-tensor-calculus">Vector and Tensor Calculus</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-note-on-inner-dot-product-operations-with-tensors">A Note on Inner/Dot Product Operations with Tensors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-9">Exercise 9</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10">Exercise 10</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Imperial College London
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>