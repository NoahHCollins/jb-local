

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Homework &#8212; Modelling and Numerical Methods</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Chapter9/Homework';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Solutions" href="Solutions.html" />
    <link rel="prev" title="9.1 Interpolation &amp; Quadrature 2" href="Lecture%209.1%20-%20interpolation%20quadrature.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Modelling and Numerical Methods
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 1 - Analytical Background</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter1/intro.html">1. Intro to Vector/Tensor Calculus</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1/Lecture%201.1%20-%20Intro%20to%20Vectors.html">1.1 Continuum Mechanics and Vector Calculus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1/Lecture%201.2%20-%20Vector%20Transformations.html">1.2 Vector Transformations  <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1/Lecture%201.3%20-%20Intro%20to%20Tensors.html">1.3 Intro to Tensors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1/exercises.html">Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1/solutions.html">Solutions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter2/intro.html">2. Stress Tensor</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2/Lecture%202%20-%20Stress%20and%20Tensors.html">2.1 Stress and Tensors  <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2/exercises2.html">Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2/solutions2.html">Solutions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter3/intro.html">3. Kinematics and Strain</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3/Lecture%203%20-%20Kinematics.html">3.1 Kinematics   <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3/exercises3.html">Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3/solutions3.html">Solutions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter4/intro.html">4. Conservation Equations</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter4/Lecture%204.1%20-%20Conservation%20Equations.html">4.1 Conservation Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter4/Lecture%204.2%20-%20Rheology.html">4.2 Rheology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter4/exercises4.html">Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter4/solutions4.html">Solutions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter5/intro.html">5. Dimensional Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter5/Lecture%205%20-%20Dimensions%20and%20Dimensional%20Analysis.html">5.1 Dimensions and Dimensional Analysis</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 2 - Numerical Solutions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter7/intro.html">7. Navier-Stokes</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter7/Lecture%207.1%20-%20Navier-Stokes.html">7.1 Solving Navier-Stokes Numerically</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter7/Worksheet.html">Worksheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter7/SolversIntro.html">Solvers</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter8/intro.html">8. Turbulence and Non-Newtonian Flows</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter8/Lecture%208.1%20-%20Turbulent%20and%20Non-Newtonian%20Flows.html">8.1 Turbulent and Non-Newtonian Flows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter8/Worksheet.html">Worksheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter8/Solutions.html">Solutions</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 3 - Numerical Techniques</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="intro.html">9. Interpolation Quadrature 2</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Lecture%209.1%20-%20interpolation%20quadrature.html">9.1 Interpolation &amp; Quadrature 2 <a class="tocSkip"></a></a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Homework <a class="tocSkip"></a></a></li>
<li class="toctree-l2"><a class="reference internal" href="Solutions.html">Solutions <a class="tocSkip"></a></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter10/intro.html">10. ODE Solvers 2</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter10/Lecture%2010.1%20-%20ODE%20Solver.html">ODE solvers (or time-stepping methods - numerical solution of IVPs) 2 <a class="tocSkip"></a></a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FChapter9/Homework.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Chapter9/Homework.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Homework <a class="tocSkip"></h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="homework-a-class-tocskip">
<h1>Homework <a class="tocSkip"><a class="headerlink" href="#homework-a-class-tocskip" title="Permalink to this heading">#</a></h1>
<section id="interpolation-quadrature-2-a-class-tocskip">
<h2>Interpolation &amp; Quadrature 2 <a class="tocSkip"><a class="headerlink" href="#interpolation-quadrature-2-a-class-tocskip" title="Permalink to this heading">#</a></h2>
<h2>Table of Contents<span class="tocSkip"></span></h2>
<div class="toc"><ul class="toc-item"><li><span><a href="#Homework" data-toc-modified-id="Homework-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>Homework</a></span><ul class="toc-item"><li><span><a href="#Homework---Newton-polynomial-[$\star$]" data-toc-modified-id="Homework---Newton-polynomial-[$\star$]-1.1"><span class="toc-item-num">1.1&nbsp;&nbsp;</span>Homework - Newton polynomial [$\star$]</a></span></li><li><span><a href="#Homework---Hat-functions-and-their-derivatives" data-toc-modified-id="Homework---Hat-functions-and-their-derivatives-1.2"><span class="toc-item-num">1.2&nbsp;&nbsp;</span>Homework - Hat functions and their derivatives</a></span></li><li><span><a href="#Homework---Error-bound-for-polynomial-interpolation-of-the-Runge-function-[$\star$]" data-toc-modified-id="Homework---Error-bound-for-polynomial-interpolation-of-the-Runge-function-[$\star$]-1.3"><span class="toc-item-num">1.3&nbsp;&nbsp;</span>Homework - Error bound for polynomial interpolation of the Runge function [$\star$]</a></span></li><li><span><a href="#Homework---Chebyshev-interpolation-[$\star$]" data-toc-modified-id="Homework---Chebyshev-interpolation-[$\star$]-1.4"><span class="toc-item-num">1.4&nbsp;&nbsp;</span>Homework - Chebyshev interpolation [$\star$]</a></span></li><li><span><a href="#Homework---Chebyshev-polynomials-as-basis-functions-[$\star\star$]" data-toc-modified-id="Homework---Chebyshev-polynomials-as-basis-functions-[$\star\star$]-1.5"><span class="toc-item-num">1.5&nbsp;&nbsp;</span>Homework - Chebyshev polynomials as basis functions [$\star\star$]</a></span></li><li><span><a href="#Homework---Cubic-spline-interpolation-[$\star\star$]" data-toc-modified-id="Homework---Cubic-spline-interpolation-[$\star\star$]-1.6"><span class="toc-item-num">1.6&nbsp;&nbsp;</span>Homework - Cubic spline interpolation [$\star\star$]</a></span></li><li><span><a href="#Homework---Implement-Weddle's-rule" data-toc-modified-id="Homework---Implement-Weddle's-rule-1.7"><span class="toc-item-num">1.7&nbsp;&nbsp;</span>Homework - Implement Weddle's rule</a></span></li><li><span><a href="#Homework---Midpoint-rule-error-[$\star$]" data-toc-modified-id="Homework---Midpoint-rule-error-[$\star$]-1.8"><span class="toc-item-num">1.8&nbsp;&nbsp;</span>Homework - Midpoint rule error [$\star$]</a></span></li><li><span><a href="#Homework---Derive-Simpson's-rule-as-quadratic-fit-[$\star\star$]" data-toc-modified-id="Homework---Derive-Simpson's-rule-as-quadratic-fit-[$\star\star$]-1.9"><span class="toc-item-num">1.9&nbsp;&nbsp;</span>Homework - Derive Simpson's rule as quadratic fit [$\star\star$]</a></span></li><li><span><a href="#Homework---Open-vs-closed-Newton-Cotes-[$\star\star$]" data-toc-modified-id="Homework---Open-vs-closed-Newton-Cotes-[$\star\star$]-1.10"><span class="toc-item-num">1.10&nbsp;&nbsp;</span>Homework - Open vs closed Newton-Cotes [$\star\star$]</a></span></li><li><span><a href="#Homework---Implement-adaptive-quadrature-[$\star$]" data-toc-modified-id="Homework---Implement-adaptive-quadrature-[$\star$]-1.11"><span class="toc-item-num">1.11&nbsp;&nbsp;</span>Homework - Implement adaptive quadrature [$\star$]</a></span></li><li><span><a href="#Homework---Implement-a-&quot;composite&quot;-version-of-Gauss-Legendre-quadrature-[$\star\star$]" data-toc-modified-id="Homework---Implement-a-&quot;composite&quot;-version-of-Gauss-Legendre-quadrature-[$\star\star$]-1.12"><span class="toc-item-num">1.12&nbsp;&nbsp;</span>Homework - Implement a "composite" version of Gauss-Legendre quadrature [$\star\star$]</a></span></li></ul></li></ul></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1"># the following allows us to plot triangles indicating convergence order</span>
<span class="kn">from</span> <span class="nn">mpltools</span> <span class="kn">import</span> <span class="n">annotation</span>
<span class="c1"># as this lecture is about interpolation we will make use of this SciPy library</span>
<span class="kn">import</span> <span class="nn">scipy.interpolate</span> <span class="k">as</span> <span class="nn">si</span>
<span class="kn">import</span> <span class="nn">scipy.integrate</span> <span class="k">as</span> <span class="nn">integrate</span>

<span class="c1"># some default font sizes for plots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;sans-serif&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.sans-serif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;Dejavu Sans&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="homework-newton-polynomial-star">
<h2>Homework - Newton polynomial [<span class="math notranslate nohighlight">\(\star\)</span>]<a class="headerlink" href="#homework-newton-polynomial-star" title="Permalink to this heading">#</a></h2>
<p>From the lecture we defined the Newton polynomial as</p>
<div class="math notranslate nohighlight">
\[ P_N(x) = a_0 +(x-x_0)a_1 + (x-x_0)(x-x_1)a_2 + \cdots + (x-x_0)(x-x_1)\ldots(x-x_{N-1})a_N,\]</div>
<p>where <span class="math notranslate nohighlight">\(a_0, a_1, \ldots, a_N\)</span> are our <span class="math notranslate nohighlight">\(N+1\)</span> free parameters we need to find using the <span class="math notranslate nohighlight">\(N+1\)</span> pieces of information we have in the given data.</p>
<p>We introduced the divided difference notation</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{alignat*}{2}
\Delta y_i &amp;= \frac{y_i-y_0}{x_i-x_0},\;\;    &amp;&amp; i=1,2,\ldots, N,\\[10pt]
\Delta^2 y_i &amp;= \frac{\Delta y_i-\Delta y_1}{x_i-x_1},\;\;    &amp;&amp; i=2, 3,\ldots, N,\\[10pt]
&amp;\vdots\\[5pt]
\Delta^N y_N &amp;= \frac{\Delta^{N-1} y_N-\Delta^{N-1} y_{N-1}}{x_N-x_{N-1}},
\end{alignat*}
\end{split}\]</div>
<p>and saw that the unknown coefficients <span class="math notranslate nohighlight">\(a\)</span> are given by</p>
<div class="math notranslate nohighlight">
\[a_0=y_0,\;\;\;\;\; a_1 = \Delta y_1, \;\;\;\;\; a_2 = \Delta^2 y_2, \;\;\;\;\; \ldots \;\;\;\;\; a_N = \Delta^N y_N.\]</div>
<p>Based upon the following pseudo code implement functions to (1) calculate the coefficients of the Newton polynomial, and (2) evaluate it for the purposes of plotting. Check visually that your plotted curve of the interpolant agrees with what we saw for the Lagrange polynomial (obtained either with SciPy our our own implementation: <code class="docutils literal notranslate"><span class="pre">Lagrange_basis_poly</span></code> and <code class="docutils literal notranslate"><span class="pre">Lagrange_interp_poly</span></code>) and passes through our data points - use the same data made up of 6 points we used in the lecture:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">])</span>
<span class="n">yi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>
</pre></div>
</div>
<p><em>Pseudo-code / code skeleton:</em></p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculate_newton_poly_coeffs</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to evaluate the coefficients a_i recursively</span>
<span class="sd">    using Newton&#39;s method.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    xi, yi : array_like</span>
<span class="sd">        The N+1 data points (i = 0, 1, ..., N)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    a : array_like</span>
<span class="sd">        Array containing the Newton polynomial coefficients</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># initialise the array &#39;a&#39; with yi, but take a copy to ensure we don&#39;t</span>
    <span class="c1"># overwrite our yi data!</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">yi</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># we have N+1 data points, and so</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="c1"># for each k, we compute Δ^k y_i from the a_i = Δ^(k-1) y_i of the previous iteration:</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="c1"># but only for i&gt;=k</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">***</span> <span class="n">you</span> <span class="n">need</span> <span class="n">to</span> <span class="n">fill</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">maths</span> <span class="n">here</span> <span class="o">***</span>

    <span class="k">return</span> <span class="n">a</span>
    
    
<span class="k">def</span> <span class="nf">eval_newton_poly</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to evaluate the Newton polynomial</span>
<span class="sd">    at x, given the data point xi and the polynomial coeffs a.</span>

<span class="sd">    a : array_like</span>
<span class="sd">        Newton polynomial coefficients</span>
<span class="sd">    xi : array_like</span>
<span class="sd">        The x-component of the data</span>
<span class="sd">    x : array_like</span>
<span class="sd">        Array of x-locations the Newton polynomial is evaluated at</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    P : array_like</span>
<span class="sd">        Newton polynomial values for points x</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># polynomial degree</span>
    <span class="c1"># recursively build up polynomial evaluated at xx</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">P</span> <span class="o">=</span> <span class="o">***</span> <span class="n">you</span> <span class="n">need</span> <span class="n">to</span> <span class="n">fill</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">maths</span> <span class="n">here</span> <span class="o">***</span>
        
    <span class="k">return</span> <span class="n">P</span>
    
<span class="c1"># set up figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="c1"># add a small margin </span>
<span class="n">ax1</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Evaluate the coefficients of the Newton polynomial</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">calculate_newton_poly_coeffs</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span>
<span class="c1"># Evaluate the polynomial at high resolution and plot</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">9.1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">eval_poly</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Newton poly&#39;</span><span class="p">)</span>

<span class="c1"># Overlay raw data</span>
<span class="n">plot_raw_data</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">ax1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Newton interpolating polynomial (our implementation)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="c1"># Add a legend</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="homework-hat-functions-and-their-derivatives">
<h2>Homework - Hat functions and their derivatives<a class="headerlink" href="#homework-hat-functions-and-their-derivatives" title="Permalink to this heading">#</a></h2>
<p>Recall that the hat functions we used as basis functions for p/w linear interpolation
are defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\phi_i(x) = 
\begin{cases}
\frac{x - x_{i-1}}{\Delta x_{i-1}}, &amp;\text{if}\;\;\; x\in e_{i-1}\equiv[x_{i-1},x_{i}] \\[5pt]
\frac{x_{i+1} - x}{\Delta x_{i}}, &amp;\text{if}\;\;\; x\in e_{i}\equiv[x_{i},x_{i+1}] \\[5pt]
0, &amp; \text{otherwise} \\
\end{cases}
\end{split}\]</div>
<p>which looks like the following:</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/fem_basis_functions.svg"><img alt="../_images/fem_basis_functions.svg" src="../_images/fem_basis_functions.svg" width="75%" /></a>
</figure>
<br>
<p>Compute an analytical expression for their derivatives and write a function to evaluate them. Plot your results, what happens if you have non-uniform interval sizes (distances between data points)?</p>
</section>
<section id="homework-error-bound-for-polynomial-interpolation-of-the-runge-function-star">
<h2>Homework - Error bound for polynomial interpolation of the Runge function [<span class="math notranslate nohighlight">\(\star\)</span>]<a class="headerlink" href="#homework-error-bound-for-polynomial-interpolation-of-the-runge-function-star" title="Permalink to this heading">#</a></h2>
<p>We can use SymPy to calculate and then plot the derivatives of the Runge function for example we can do something like</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="mf">25.</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;f(x) = &quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">f</span><span class="p">)))</span>
<span class="n">f_</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">f</span><span class="p">)</span>

<span class="n">dfdx</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;f&#39;(x) = &quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">dfdx</span><span class="p">)))</span>
<span class="n">dfdx_</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">dfdx</span><span class="p">)</span>

<span class="n">dfdx2</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dfdx</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;f&#39;&#39;(x) = &quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">dfdx2</span><span class="p">)))</span>
<span class="n">dfdx2_</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">dfdx2</span><span class="p">)</span>

<span class="n">dfdx3</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dfdx2</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;f&#39;&#39;&#39;(x) = &quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">dfdx3</span><span class="p">)))</span>
<span class="n">dfdx3_</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">dfdx3</span><span class="p">)</span>

<span class="n">xf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">w_pad</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xf</span><span class="p">,</span> <span class="n">f_</span><span class="p">(</span><span class="n">xf</span><span class="p">),</span> <span class="s1">&#39;b&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;f(x)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xf</span><span class="p">,</span> <span class="n">dfdx_</span><span class="p">(</span><span class="n">xf</span><span class="p">),</span> <span class="s1">&#39;b&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;f&#39;(x)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xf</span><span class="p">,</span> <span class="n">dfdx2_</span><span class="p">(</span><span class="n">xf</span><span class="p">),</span> <span class="s1">&#39;b&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;f&#39;&#39;(x)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xf</span><span class="p">,</span> <span class="n">dfdx3_</span><span class="p">(</span><span class="n">xf</span><span class="p">),</span> <span class="s1">&#39;b&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;f&#39;&#39;&#39;(x)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>and to compute an <span class="math notranslate nohighlight">\((N+1)\)</span>-st derivative, say, we could do something like</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">f</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> 
</pre></div>
</div>
<p>Play around a bit with SymPy and try plotting our error bound</p>
<div class="math notranslate nohighlight">
\[\left| f(x) - P_N(x) \right| \le \frac{1}{(N+1)!}\, M\, \left|\Psi_N(x)\right|
\;\;\;\;\;\;\text{where}\;\;\;\;\;\;
M:=\max_{x\in(a,b)}\, \left| f^{(N+1)}(x) \right|,\]</div>
<p>you should see that as you increase <span class="math notranslate nohighlight">\(N\)</span> the error bound gets larger quite rapidly and more and more focused at the end points of our interval.</p>
</section>
<section id="homework-chebyshev-interpolation-star">
<h2>Homework - Chebyshev interpolation [<span class="math notranslate nohighlight">\(\star\)</span>]<a class="headerlink" href="#homework-chebyshev-interpolation-star" title="Permalink to this heading">#</a></h2>
<p>Consider the cell in the lecture where we computed and plotted the Chebyshev interpolant using a call to <code class="docutils literal notranslate"><span class="pre">si.lagrange</span></code> (from inside the function <code class="docutils literal notranslate"><span class="pre">plot_approximation</span></code>), i.e. where the loop read</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">degree</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">degrees</span><span class="p">):</span>
    <span class="c1"># the Chebyshev nodes</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">degree</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">degree</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
    <span class="c1"># compute and plot the Lagrange polynomial using Chebyshev nodes as data locations</span>
    <span class="n">plot_approximation</span><span class="p">(</span><span class="n">runge</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">runge</span><span class="p">(</span><span class="n">xi</span><span class="p">),</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Degree </span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">degree</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
<p>Recreate the four plots that resulted, but update the code (specifically our function <code class="docutils literal notranslate"><span class="pre">plot_approximation</span></code>) so that it instead calls our Lagrangian interpolation function <code class="docutils literal notranslate"><span class="pre">Lagrange_interp_poly</span></code>.</p>
</section>
<section id="homework-chebyshev-polynomials-as-basis-functions-star-star">
<h2>Homework - Chebyshev polynomials as basis functions [<span class="math notranslate nohighlight">\(\star\star\)</span>]<a class="headerlink" href="#homework-chebyshev-polynomials-as-basis-functions-star-star" title="Permalink to this heading">#</a></h2>
<p>Recall from lectures that the degree <span class="math notranslate nohighlight">\(N\)</span> Lagrange polynomial interpolating <span class="math notranslate nohighlight">\(N+1\)</span> data points is given by</p>
<div class="math notranslate nohighlight">
\[L(x) := \sum_{i=0}^{N} y_i \ell_i(x),\]</div>
<p>where the <span class="math notranslate nohighlight">\(\ell_i(x)\)</span> are the Lagrange basis functions defined by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\ell_i(x) := \prod_{\begin{smallmatrix}0\le m\le N\\ m\neq i\end{smallmatrix}} \frac{x-x_m}{x_i-x_m},\end{split}\]</div>
<p>[note that each of these basis functions is itself a degree <span class="math notranslate nohighlight">\(N\)</span> polynomial].</p>
<p>A general result is the following:</p>
<p>If the <span class="math notranslate nohighlight">\(N+1\)</span> data locations, <span class="math notranslate nohighlight">\(x_0 &lt; x_1 &lt; \ldots &lt; x_N,\)</span> are the roots of some (N+1) degree polynomial <span class="math notranslate nohighlight">\(\phi_{N+1}(x)\)</span>  (from an <a class="reference external" href="https://en.wikipedia.org/wiki/Orthogonal_polynomials"><em>orthogonal family</em> of polynomials</a>, e.g. the <a class="reference external" href="https://en.wikipedia.org/wiki/Chebyshev_polynomials"><em>Chebyshev polynomials</em></a>) we introduced in lecture and have a nice minimal error property, then the Lagrange basis functions are equivalent to</p>
<div class="math notranslate nohighlight">
\[\ell_i(x) \equiv \frac{\phi_{N+1}(x)}{(x - x_i)\phi'_{N+1}(x_i)},\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi'\)</span> is the derivative of <span class="math notranslate nohighlight">\(\phi\)</span>.  [See Chebyshev Polynomials, by J.C. Mason, D.C. Handscomb (Chapter 6)].</p>
<p>In the specific case we discussed in class where the <span class="math notranslate nohighlight">\(x_0 &lt; x_1 &lt; \ldots &lt; x_N,\)</span> are the roots of the Chebyshev polynomial (which was the choice which minimised the issue we had with interpolation of the Runge function) we have that the Lagrange basis functions are equivalent to</p>
<div class="math notranslate nohighlight">
\[\ell_i(x) = \frac{T_{N+1}(x)}{(N+1)(x - x_i)U_{N}(x_i)},\]</div>
<p>where <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(U\)</span> are the Chebyshev polynomials of the first and second kind respectively, i.e. the Lagrange basis functions are equivalent to scaled Chebyshev polynomials.</p>
<p>Now of course we end up at the same final interpolating polynomial as we did with the standard Lagrange polynomial approach, but now the basis functions are not all degree <span class="math notranslate nohighlight">\(N\)</span> polynomials (as we will see in the code and web links directly below).</p>
<p>Try updating our function <code class="docutils literal notranslate"><span class="pre">Lagrange_interp_poly</span></code> so that instead of calling the function <code class="docutils literal notranslate"><span class="pre">Lagrange_basis_poly</span></code> to compute the Lagrange basis functions using the expression at the top of this cell, it calls a new function which computes the basis functions in terms of the above formula involving Chebyshev polynomials of the first (<span class="math notranslate nohighlight">\(T\)</span>) and second (<span class="math notranslate nohighlight">\(U\)</span>) kind.</p>
<p>You can use the recurrence relations defining these families of polynomials here: <a class="reference external" href="https://en.wikipedia.org/wiki/Chebyshev_polynomials#Definition">https://en.wikipedia.org/wiki/Chebyshev_polynomials#Definition</a></p>
<p>As a hint here is a function which computes the polynomial of the first kind (you’ll need to code up the second kind yourself)</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Chebyshev_first_kind</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to compute the Chebyshev polynomial of the first kind.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N : int</span>
<span class="sd">        Degree of the polynomial</span>
<span class="sd">    x : array_like</span>
<span class="sd">        Array of x-locations the polynomial is evaluated at</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    T : ndarray</span>
<span class="sd">        Chebyshev polynomial of the first kind evaluated at x</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
    <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">T</span>
    <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">x</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">T</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">T</span><span class="p">[</span><span class="n">n</span><span class="p">,:]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">T</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">-</span> <span class="n">T</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">,:]</span>
    <span class="k">return</span> <span class="n">T</span>
</pre></div>
</div>
<p>And as a further hint, in my solution I replace these lines from <code class="docutils literal notranslate"><span class="pre">Lagrange_interp_poly</span></code></p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span>    <span class="n">l</span> <span class="o">=</span> <span class="n">Lagrange_basis_poly</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">xi</span><span class="p">)):</span>
        <span class="n">L</span> <span class="o">=</span> <span class="n">L</span> <span class="o">+</span> <span class="n">yi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
<p>with</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span>    <span class="n">T</span> <span class="o">=</span> <span class="n">Chebyshev_first_kind</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">U</span> <span class="o">=</span> <span class="n">Chebyshev_second_kind</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">xi</span><span class="p">)</span>
    <span class="n">Chebyshev_interpolant</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">xi</span><span class="p">)):</span>
        <span class="n">Chebyshev_interpolant</span> <span class="o">=</span> <span class="n">Chebyshev_interpolant</span>  \
            <span class="o">+</span> <span class="n">yi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span><span class="o">/</span><span class="p">((</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">U</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
<p>I called the new function <code class="docutils literal notranslate"><span class="pre">Chebyshev_interp_poly</span></code>.</p>
<p>Test your answer by recreating the above plots of the approximation (obtained using <code class="docutils literal notranslate"><span class="pre">Lagrange_interp_poly</span></code>) to the Runge functions using <code class="docutils literal notranslate"><span class="pre">degrees</span> <span class="pre">=</span> <span class="pre">[5,</span> <span class="pre">9,</span> <span class="pre">12,</span> <span class="pre">20]</span></code>.</p>
</section>
<section id="homework-cubic-spline-interpolation-star-star">
<h2>Homework - Cubic spline interpolation [<span class="math notranslate nohighlight">\(\star\star\)</span>]<a class="headerlink" href="#homework-cubic-spline-interpolation-star-star" title="Permalink to this heading">#</a></h2>
<p>Write some code to implement and plot a cubic spline and recreate the figure from class obtained using SciPy, based on the theory below. If you get this right and if you do a little bit of extrapolation outside our data range then you will see that the behaviour here does not quite agree with SciPy. Read the SciPy docs to see why this is (consider the default boundary conditions) and redo the SciPy plot to agree with your code.</p>
</section>
<section id="homework-implement-weddle-s-rule">
<h2>Homework - Implement Weddle’s rule<a class="headerlink" href="#homework-implement-weddle-s-rule" title="Permalink to this heading">#</a></h2>
<p>As explained in the lecture, we can implement Weddle’s rule using appropriate calls to the <code class="docutils literal notranslate"><span class="pre">simpsons_composite_rule</span></code> function.</p>
<p>Do this and try to recreate the convergence plot from the lecture:</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/weddle_convergence.png"><img alt="../_images/weddle_convergence.png" src="../_images/weddle_convergence.png" style="width: 75%;" /></a>
</figure>
</section>
<section id="homework-midpoint-rule-error-star">
<h2>Homework - Midpoint rule error [<span class="math notranslate nohighlight">\(\star\)</span>]<a class="headerlink" href="#homework-midpoint-rule-error-star" title="Permalink to this heading">#</a></h2>
<p>In class we stated that a bound on the midpoint rule’s error is given by</p>
<div class="math notranslate nohighlight">
\[ \left| E_M^n \right| \le \frac{(b-a)^3}{24n^2}  \max_{x\in[a,b]}\, \left| f''(x) \right|. \]</div>
<p>And we noted that for midpoint (and all odd order Newton-Cotes rules including Simpson’s rule) we gain an order of precision/accuracy over what we might expect, i.e. here this error bound indicates that the method is second-order accurate
and integrates linear polynomials exactly.</p>
<p>If we follow the error bound derivation we performed in lecture for the Trapezoidal rule, we would progress by
taking <span class="math notranslate nohighlight">\(N=0\)</span> (as the midpoint rule is fitting a constant, degree zero, function) and using our Lagrange remainder result to estimate the <em>interpolation error</em> over the interval <span class="math notranslate nohighlight">\([a,b]\)</span> as:</p>
<div class="math notranslate nohighlight">
\[R_0(x) = \left(x - \frac{1}{2}(a+b)\right) {f'(c_x)}.\]</div>
<p>Our Midpoint rule quadrature error over a single interval <span class="math notranslate nohighlight">\([a,b]\)</span> could then be estimated via</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
E_M \equiv E_0 = I - I_0 
&amp;= \int_{a}^{b} f\left ( x \right )\, dx - \int_a^b\,P_0\left ( x \right )\,dx \\[5pt]
&amp;= \int_{a}^{b} f\left ( x \right ) - P_0\left ( x \right ) \, dx\\[5pt] 
&amp;= \int_{a}^{b} R_0\left ( x \right )\, dx.
\end{align*}
\end{split}\]</div>
<p>Substitute in the above expression for <span class="math notranslate nohighlight">\(R_0(x)\)</span> and demonstrate that this leading order term in the error expansion is indeed zero.</p>
<p>Once you’ve convinced yourself of this I suggest take a look at my derivation of the error bound in the sample solution which involves taking the next order term in the Taylor series expansion about the midpoint of an interval.</p>
</section>
<section id="homework-derive-simpson-s-rule-as-quadratic-fit-star-star">
<h2>Homework - Derive Simpson’s rule as quadratic fit [<span class="math notranslate nohighlight">\(\star\star\)</span>]<a class="headerlink" href="#homework-derive-simpson-s-rule-as-quadratic-fit-star-star" title="Permalink to this heading">#</a></h2>
<p>We stated in the lecture that:</p>
<p>Note that an alternate derivation of the same rule involves fitting a <em>quadratic function</em> (i.e. <span class="math notranslate nohighlight">\(P_2(x)\)</span> rather than the constant and linear approximations already considered) that interpolates the integral at the two end points of the interval, <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>, as well as at the midpoint, <span class="math notranslate nohighlight">\(c = \left ( a+b\right )/2\)</span>, and calculating the integral under that polynomial approximation. We’ll come back to this idea a bit later.</p>
<p>Take a look also at the Newton-Cotes section of the lecture where we derived the Trapezoidal rule with the choice <span class="math notranslate nohighlight">\(N=1\)</span>. We arrive at Simpson’s (1/3) rule if we repeat this process with <span class="math notranslate nohighlight">\(N=2\)</span>.</p>
<p>Do this.</p>
<br>
<p><strong>Hint:</strong> Note that following the derivation of the Trapezoidal rule from lectures you will need to evaluate integrals of the form</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
A_0 &amp;= \int_{x_0}^{x_2}\, \ell_0(x)\, dx \\[5pt]
&amp; = \frac{1}{(x_0-x_1)(x_0-x_2)}\int_{x_0}^{x_2}\, (x-x_1)(x - x_2) \, dx.
\end{align*}
\end{split}\]</div>
<p>This integral is much easier to do if you introduce the new variable (i.e. a <a class="reference external" href="https://en.wikipedia.org/wiki/Integration_by_substitution">change of variables</a>) <span class="math notranslate nohighlight">\(\xi\)</span> such that <span class="math notranslate nohighlight">\(d\xi = dx\)</span> and <span class="math notranslate nohighlight">\(\xi=0\)</span> corresponds to <span class="math notranslate nohighlight">\(x_1\)</span>, <span class="math notranslate nohighlight">\(\xi = -h\)</span> corresponds to <span class="math notranslate nohighlight">\(x_0\)</span> and <span class="math notranslate nohighlight">\(\xi = h\)</span> corresponds to <span class="math notranslate nohighlight">\(x_2\)</span>. Note therefore that the interval size <span class="math notranslate nohighlight">\(x_2-x_0 = 2h\)</span>.</p>
<p>Your integral then becomes</p>
<p>$<span class="math notranslate nohighlight">\(
\begin{align*}
A_0 &amp; = \frac{1}{(x_0-x_1)(x_0-x_2)}\int_{x_0}^{x_2}\, (x-x_1)(x - x_2) \, dx \\[5pt]
&amp; = \frac{1}{(-h)(-2h)}\int_{-h}^{h}\, \xi(\xi - h) \, d\xi = \ldots = \frac{h}{3}.
\end{align*}
\)</span>$s</p>
<p>Fill in the gaps and do the other integrals to complete the derivation.</p>
</section>
<section id="homework-open-vs-closed-newton-cotes-star-star">
<h2>Homework - Open vs closed Newton-Cotes [<span class="math notranslate nohighlight">\(\star\star\)</span>]<a class="headerlink" href="#homework-open-vs-closed-newton-cotes-star-star" title="Permalink to this heading">#</a></h2>
<p>Implement an open Newton-Cotes formula and use it to integrate <span class="math notranslate nohighlight">\(1/\sqrt{x}\)</span>  from 0 to 1.</p>
<p><strong>Hint:</strong> Check the open formulae here <a class="reference external" href="https://en.wikipedia.org/wiki/Newton%E2%80%93Cotes_formulas#Open_Newton%E2%80%93Cotes_formulas">https://en.wikipedia.org/wiki/Newton–Cotes_formulas#Open_Newton–Cotes_formulas</a>.  My solution makes use of  Milne’s rule which evaluates the function at the appropriate points within each sub-interval, and so uses more function evaluations for a given number of intervals compared to the composite version of Simpson’s rule.</p>
<p>Compare your solution with a closed scheme such as Simpson’s, e.g. by recreating a convergence plot such as that presented in the Lecture.</p>
<p><strong>Hint:</strong>  Note that to avoid divide by zero warning you could define your integrand via something like:
<code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">x:</span> <span class="pre">1./(np.maximum(1e-16,np.sqrt(x)))</span></code></p>
</section>
<section id="homework-implement-adaptive-quadrature-star">
<h2>Homework - Implement adaptive quadrature [<span class="math notranslate nohighlight">\(\star\)</span>]<a class="headerlink" href="#homework-implement-adaptive-quadrature-star" title="Permalink to this heading">#</a></h2>
<p>Based on the algorithm description from the lecture, try to implement an adaptive quadrature algorithm and apply it to our complicated function given in the following cell.</p>
<br>
<p><strong>Hint:</strong>  My function and an explanatory docstring starts</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">adaptive_simpson_recursive</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="n">S</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; S is a Simpson rule estimate of the integral over interval [a,b]</span>
<span class="sd">    This function computes S2 by splitting the current interval in half </span>
<span class="sd">    and evaluating Simpson&#39;s rule over each of the two resulting sub-intervals. </span>
<span class="sd">    It then evaluates an estimate of the quadrature error over the interval as </span>
<span class="sd">    (S2-S)/15, and if we have not yet reached the desired error tolerance it </span>
<span class="sd">    divides the current interval [a,b] in two and applies the same function to </span>
<span class="sd">    each half: [a,c] and [c,b]. </span>
<span class="sd">    If an error tolerance has been reached it returns the Weddle estimate for</span>
<span class="sd">    the integral over [a,b]: S2 + (S2 - S)/15.0.</span>
<span class="sd">    The function recursively sums the result from each subinterval considered. </span>
<span class="sd">    `locs&#39; is a global variable that contains all the locations we evaluate the</span>
<span class="sd">    function at.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
<br>
<p><strong>I’ve listed this as optional rather than advanced as I think it’s a good one to work through, but it is quite involved and could easily have been tagged as “advanced”.</strong></p>
<p><strong>Note that you should NOT assume I’ve done this as I’m planning on this being part of the assessment - it will NOT be.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># a more complex example (taken from Moin which quotes the exact integral as −0.56681975015)</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The function we wish to integrate.</span>
<span class="sd">    </span>
<span class="sd">    This a more complicated example which has been taken from the book by Moin.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">-</span>
            <span class="p">(</span><span class="mf">0.01</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.001</span><span class="p">))</span> <span class="o">+</span>
            <span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>

<span class="c1"># exact solution obtained with (si.quad(f, -1, 1, epsabs=1e-16))</span>
<span class="c1"># NB. the &quot;exact&quot; value given in Moin only to 11 s.f.s: −0.56681975015</span>
<span class="n">I_exact</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5668197501529302</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="homework-implement-a-composite-version-of-gauss-legendre-quadrature-star-star">
<h2>Homework - Implement a “composite” version of Gauss-Legendre quadrature [<span class="math notranslate nohighlight">\(\star\star\)</span>]<a class="headerlink" href="#homework-implement-a-composite-version-of-gauss-legendre-quadrature-star-star" title="Permalink to this heading">#</a></h2>
<p>Implement a “composite” version of Gauss-Legendre, i.e. split up the total interval into sub-intervals, apply Gauss-Legendre on each subinterval and sum.</p>
<p>Compare this method, for differing degrees, against the composite Simpson rule for our <span class="math notranslate nohighlight">\(\sin\)</span> and more complex function we considered in lecture.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Chapter9"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="Lecture%209.1%20-%20interpolation%20quadrature.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">9.1 Interpolation &amp; Quadrature 2 <a class="tocSkip"></p>
      </div>
    </a>
    <a class="right-next"
       href="Solutions.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Solutions <a class="tocSkip"></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Imperial College London
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>